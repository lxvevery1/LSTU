!function(){var t,e,n,r,o={6866:function(t,e,n){"use strict";n.d(e,{Db:function(){return y},G2:function(){return p},JZ:function(){return v},LM:function(){return u},QU:function(){return b},XI:function(){return l},ZW:function(){return m},aU:function(){return c},cc:function(){return i},hR:function(){return g},nd:function(){return h},pK:function(){return d},rh:function(){return o},rr:function(){return a},sv:function(){return s},vn:function(){return r},yW:function(){return f}});var r="onConversationCreate",o="onMessageSent",i="onMessageReceived",a="onUnreadCountChange",u="onConversationEnded",c="onAssistantEnded",s="onConversationUnended",l="onSatisfactionReceived",f="onAgentTypingActivity",d="onConversationMerged",v="onCustomerDelete",p="onConversationDeleted",b="onLogin",g="onLogout",h=25,m=100,y=100},2838:function(t,e,n){"use strict";n.d(e,{eI:function(){return u},s5:function(){return a},AG:function(){return i},N0:function(){return o}});var r=n(3182),o=function(t){if(null==t||!t.assistant)return new Error("Missing one or more of the required properties: assistant")},i=function(t){var e=t.lang,n=(0,r.A0)(e),o="/c/v1/chat/assistant/init";return n&&(o="".concat(o,"?lang=").concat(n)),o},a=function(t){return"/c/v2/chat/assistant/sessions/".concat(t,"/deflections")},u=new Map},3712:function(t,e,n){"use strict";n.d(e,{fH:function(){return f},He:function(){return l},BQ:function(){return s}});var r=n(9591),o=n(4552),i=n(9111);function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s=function(t){var e=t.attributes,n=t.custom,o=function(t){var e=null==t?void 0:t.attributes,n=null==t?void 0:t.custom;return e||n?e?function(t){var e,n=["emails","phones","socials"],r=["sharedEmails","sharedPhones","sharedSocials"].concat(n);return Object.entries(t).every((function(t){var o,i,a=t[0],u=t[1];return n.includes(a)&&console.warn("Kustomer: The attribute ".concat(a," is deprecated. Please use shared").concat(a.charAt(0).toUpperCase()).concat(a.slice(1)," instead.")),r.includes(a)?"socials"!==a&&"sharedSocials"!==a||(i=["twitter","instagram","facebook","linkedin"],u.every((function(t){return t.type&&t.username?!!i.includes(t.type)||(o=new Error("".concat(t.type," is not a valid social type. Socials must be one of: twitter, instagram, linkedin, facebook")),!1):(o=new Error("Social is missing one or more of the required properties: username, type"),!1)})),!(e=o)):(e=new Error("".concat(a," is not a valid attribute. Attributes must contain at least one of: sharedEmails, sharedPhones, sharedSocials")),!1)})),e}(e):void 0:new Error("Missing one or more of the required properties: attributes, customAttributes")}(t);return o?Promise.reject(o):(0,r.F6)("/c/v1/customers/current",{body:JSON.stringify(u(u({},e),{},{custom:n}))})},l=function(){return(0,r.Jt)("/c/v1/chat/customers/current").then((function(t){return(0,o.fF)("customerContext",function(t){var e,n,r,o,i,a,u=(null==t||null===(e=t.data)||void 0===e?void 0:e.attributes)||{},c=u.activityAt,s=u.createdAt,l=u.lastMessageAt,f=u.lastMessageSentAt,d=u.lastOutboundMsgSentAt,v=u.lastSeenAt,p=u.signedUpAt,b=u.lastMessageUnrespondedTo,g=u.avgSatisfactionRating,h=u.avgSatisfactionScore,m=u.name,y=u.email,w=u.phone,O=u.sentiment,_=u.company,j=u.custom,P=(null==t||null===(n=t.data)||void 0===n||null===(r=n.attributes)||void 0===r?void 0:r.conversationCount)||{};return{activityAt:c,createdAt:s,lastMessageAt:l,lastMessageSentAt:f,lastMessageOutSentAt:d,lastSeenAt:v,signedUpAt:p,lastMessageUnrespondedToSentAt:b,satisfactionLevel:{avgRating:g,avgScore:h},conversationCounts:{all:P.all,done:P.done,open:P.open,snoozed:P.snoozed},name:m,email:y,phone:w,sentiment:O,company:_,createdBy:((null==t||null===(o=t.data)||void 0===o||null===(i=o.relationships)||void 0===i||null===(a=i.createdBy)||void 0===a?void 0:a.data)||{}).id,custom:j}}(t)),t}))},f=function(t){return(0,r.Jt)(i.aO).then((function(e){var n=e.data.attributes,r={total:n.totalUnreadCount,conversations:u({},n.sessionsWithUnreads)};return(0,o.NT)(r),"function"==typeof t&&t(),r}))}},6127:function(t,e,n){"use strict";n.d(e,{oH:function(){return d},R9:function(){return b},Nz:function(){return p},ML:function(){return v}});var r=n(7556),o=n(9591);function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var a=function(t){if(null==t||!t.length)return Promise.reject();var e=function(t){return t.find((function(t){return!t.file}))?new Error("Attachment is missing one or more of the required properties: file"):function(t){var e,n=0;return t.every((function(t){return n+=t.size,e=function(t){if(t.size>5e6)return new Error("Individual attachment file size is greater than 5MB")}(t),!e})),e||(n>9e6?new Error("Total attachments file size is greater than 9MB"):void 0)}(t.map((function(t){return t.file})))||void 0}(t);if(e)return Promise.reject(e);var n=t.reduce((function(t,e){var n,a,u,c=(a=(n=e).file,(0,r.a)().then((function(){var t;return(0,o.bE)("/c/v1/chat/attachments",{body:JSON.stringify({contentLength:a.size,contentType:a.type,name:a.name})}).then((function(e){return t=e,function(t,e){var n;if(null==e||null===(n=e.meta)||void 0===n||!n.upload)return Promise.reject();var r=e.meta.upload,i=r.fields,a=r.url,u=new FormData;return Object.entries(i).forEach((function(t){u.append(t[0],t[1])})),u.append("file",t.file),(0,o.hl)(a,u)}(n,e)})).then((function(){return t}))})));return[].concat(function(t){if(Array.isArray(t))return i(t)}(u=t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(u)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(u)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[c])}),[]);return Promise.all(n)},u=n(3182),c=function(t,e){var n=t.lang,r=(0,u.A0)(n);return r?"".concat(e,"?lang=").concat(r):e};function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){f(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d=function(t,e){var n=function(t,e){if(!t)return new Error("A conversationId must be provided.");var n=null==e?void 0:e.body,r=null==e?void 0:e.attachments;return n||null!=r&&r.length?void 0:new Error("Message is missing one or more of the required properties: body or attachments")}(t,e);if(n)return Promise.reject(n);var i=null==e?void 0:e.body,u=null==e?void 0:e.payload,s=null==e?void 0:e.attachments,f=null==e?void 0:e.lastDeflection,d=null==e?void 0:e.isInAssistantMode,v=null==e?void 0:e.initAssistantPayload;return(0,r.a)().then((function(){if(null!=s&&s.length)return a(s)})).then((function(n){var r,a,s;n&&(s=n.map((function(t){var e;return null==t||null===(e=t.data)||void 0===e?void 0:e.id})));var p={session:t,body:i,payload:u,lastDeflection:f,attachments:s,assistant:null==v?void 0:v.assistant,dialog:null==v?void 0:v.dialog,node:null==v?void 0:v.node,initialMessages:null==v?void 0:v.initialMessages},b=null!=e&&null!==(r=e.assistantOptions)&&void 0!==r&&r.emulation?l(l({},p),{},{assistantOptions:null==e?void 0:e.assistantOptions}):p;return d?(0,o.bE)(c(e,"/c/v2/chat/assistant/messages"),{body:JSON.stringify(b)}):(0,o.bE)(c(e,"/c/v2/chat/messages"),{body:JSON.stringify({session:t,body:i,payload:u,lastDeflection:f,attachments:s,initialMessages:null==v?void 0:v.initialMessages,initialMessagesUserId:null==v||null===(a=v.attributes)||void 0===a?void 0:a.aiUserId})})}))},v=function(t){return(0,o.Jt)(function(t){return"/c/v1/chat/messages/".concat(t,"/attachments")}(t))},p=function(t,e){return(0,o.Jt)(function(t,e){var n="/c/v2.1/chat/sessions/".concat(t,"/messages?count=").concat(e.count);return e.before?"".concat(n,"&before=").concat(e.before):n}(t,e))},b=function(t){return new Promise((function(e){setTimeout((function(){e(v(t))}),400)}))}},5506:function(t,e,n){"use strict";n.d(e,{FQ:function(){return i},ZE:function(){return a},jk:function(){return o}});var r=n(3182),o=function(t,e){if(!t)return new Error("A satisfactionId must be provided.");var n=e.rating,r=e.answers;return r&&r.find((function(t){var e;return(null===(e=t.answer)||void 0===e?void 0:e.length)>1024}))?new Error("Answers cannot exceed 1024 characters"):n&&("number"!=typeof n||n>10||n<1)?new Error("Rating must be a number between 1 and 10"):void 0},i=function(t,e,n){var r,o,i,a,u,c,s={},l=null==t||null===(r=t.relationships)||void 0===r||null===(o=r.conversation)||void 0===o||null===(i=o.data)||void 0===i?void 0:i.id,f=null==t||null===(a=t.relationships)||void 0===a||null===(u=a.session)||void 0===u||null===(c=u.data)||void 0===c?void 0:c.id;if(!t||!n||!l&&!f)return s;var d=t.id,v=t.attributes,p=v.rating,b=v.answers,g=v.createdAt,h=v.lockedAt;s.conversationId=l||f,s.satisfactionId=d;var m=g;if(e){var y=Number(e)/1e4;m=new Date(y).toISOString()}if(s.timetoken=m,s.lockedAt=h,s.response={rating:p,answers:b},n){var w=n.attributes,O=w.description,_=w.introduction,j=w.name,P=w.questions,I=w.ratingPrompt,k=w.scale;s.form={description:O,introduction:_,name:j,questions:P,ratingPrompt:I,scale:k}}return s},a=function(t,e){var n=(0,r.A0)(e),o="/c/v3/chat/satisfaction-responses/".concat(t,"?include=satisfaction");return n&&(o+="&lang=".concat(n)),o}},9238:function(t,e,n){"use strict";n.d(e,{B:function(){return r}});var r="/p/v1/schedules/:scheduleId?include=holidays"},9111:function(t,e,n){"use strict";n.d(e,{$e:function(){return r},aO:function(){return o}});var r="/c/v2/chat/sessions",o="/c/v2/chat/session-stats"},6649:function(t,e,n){"use strict";n.d(e,{jw:function(){return p},Ht:function(){return g},S5:function(){return b},qO:function(){return h},WE:function(){return m}});var r=n(4552),o=n(7556),i=n(9591),a=n(3415),u=n(3182),c=n(9111),s=function(t){if(!t)return new Error("A conversationId must be provided.")},l=function(t){return"/c/v2/chat/sessions/".concat(t)};function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){v(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var p=function(t){var e=function(t){var e=null==t?void 0:t.title;if(e&&(0,a.Kg)(e)&&e.length>256)return new Error("Title must be less than or equal to 256 characters")}(t);return e?Promise.reject(e):(0,o.a)().then((function(){return(0,i.bE)(function(t){var e=null==t?void 0:t.lang,n=(0,u.A0)(e);return n?"/c/v2.1/chat/sessions?lang=".concat(n):"/c/v2.1/chat/sessions"}(t),{body:JSON.stringify({title:t.title,assistant:t.assistant,brand:t.brand,custom:t.custom})}).then((function(t){var e=t.data.relationships.customer.data.id;return(0,r.fF)("customerId",e),(0,r.Y_)(t.data),t}))}))},b=function(t){return(0,i.Jt)((e=t,n=c.$e,o=null==e?void 0:e.page,a=null==e?void 0:e.pageSize,u=null==e?void 0:e.brandId,s=[],o&&s.push("page=".concat(o)),a&&s.push("pageSize=".concat(a)),u&&s.push("brandId=".concat(u)),s.length&&(n="/c/v2/chat/sessions?".concat(s.join("&"))),n)).then((function(t){var e=null==t?void 0:t.data.filter((function(t){var e,n=null==t||null===(e=t.attributes)||void 0===e?void 0:e.pubnub;return n&&!(null!=n&&n.error)}));return null==e||e.forEach((function(t){(0,r.Y_)(t)})),d(d({},t),{},{data:e})}));var e,n,o,a,u,s},g=function(t){var e=s(t);return e?Promise.reject(e):(0,i.Jt)(l(t)).then((function(t){return(0,r.Y_)(t.data),t}))},h=function(t,e){var n=s(t);return n?Promise.reject(n):(0,i.yJ)(l(t),{body:JSON.stringify(e)}).then((function(t){return(0,r.Y_)(t.data),t}))},m=function(t){var e=null==t?void 0:t.body;return(0,i.F6)(function(t){var e=null==t?void 0:t.sessionId,n=null==t?void 0:t.messageIds;return"/c/v2/chat/sessions/".concat(e,"/messages/").concat(n)}(t),{body:JSON.stringify(e)})}},7556:function(t,e,n){"use strict";n.d(e,{u:function(){return a},a:function(){return u}});var r,o=n(3566),i=n(9591),a=function(){return(0,i.Jt)("/c/v1/tracking/tokens/current").then((function(t){var e=t.data.attributes.token;return(0,o.KI)(e),t}))},u=function(){return(0,o.Fb)()?Promise.resolve():r||(r=a().then((function(){r=void 0})))}},7162:function(t,e,n){"use strict";n.d(e,{IZ:function(){return i}});var r="https",o=null==="https://api.kustomerapp.com"?void 0:"https://api.kustomerapp.com".replace("".concat(r,"://"),""),i=function(){return{protocol:r,baseUrlDomain:o}}},7289:function(t,e,n){"use strict";n.d(e,{_:function(){return f}});var r=n(7162);function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var u,c=function(t){try{if(!t)throw new Error;var e=(o=t.split("."),i=2,function(t){if(Array.isArray(t))return t}(o)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(o,i)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(o,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=(e[0],e[1]),r=JSON.parse(atob(n));return function(t){["orgName"].every((function(e){return e in t}))||console.error("You've provided an invalid Kustomer api key.")}(r),r}catch(t){return console.error("You've provided an invalid Kustomer api key."),{}}var o,i}(null===(u=window.parent.KustomerCore)||void 0===u?void 0:u.a),s=c.orgName,l=c.pod,f=function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({pod:l,orgName:s},(0,r.IZ)())}},3041:function(t,e,n){"use strict";n.d(e,{M:function(){return a},v:function(){return i}});var r=n(6866),o=n(4552),i=function(t){return!![r.vn,r.rh,r.cc,r.rr,r.LM,r.sv,r.aU,r.XI,r.yW,r.QU,r.hR,r.pK,r.JZ,r.G2].includes(t)||(console.error("Provided Kustomer event type is invalid: ".concat(t)),!1)},a=function(t,e,n){var r=(0,o.KA)().listeners[t];null!=r&&r.length&&r.forEach((function(t){e||n?t(e,n):t()}))}},3415:function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,{E$:function(){return i},Kg:function(){return a},RC:function(){return u},iv:function(){return o}});var o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=function(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t);if(e<=0)return n;for(;o.length;)n.push(o.splice(0,e));return n},i=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.filter((function(t){return n.every((function(e){return e.includes(t)}))}))},a=function(t){return"string"==typeof t},u=function(){var t=window;if(!t||!t.KustomerMain)throw Error("KustomerMain object not found");return t.KustomerMain}},4619:function(t,e,n){"use strict";n.d(e,{$L:function(){return a},A4:function(){return u},AP:function(){return O},Cx:function(){return v},FJ:function(){return l},KE:function(){return y},MZ:function(){return i},Mx:function(){return p},Nl:function(){return h},RT:function(){return o},UM:function(){return b},YA:function(){return _},ZG:function(){return c},ci:function(){return s},gV:function(){return d},jC:function(){return w},nV:function(){return f},sX:function(){return g},us:function(){return r},x0:function(){return j},y8:function(){return m}});var r="PNSubscribeOperation",o="PNAccessDeniedCategory",i="PNReconnectedCategory",a="PNNetworkUpCategory",u="PNNetworkDownCategory",c=["PNNetworkIssuesCategory","PNBadRequestCategory",o],s="kustomer.app.chat.session.end",l="kustomer.assistant.chat.session.end",f="kustomer.app.chat.message.receive",d="kustomer.app.chat.message.send",v="kustomer.app.chat.session.update",p="kustomer.app.chat.session.delete",b="kustomer.app.chat.csat.send",g="kustomer.app.chat.csat.submit",h="kustomer.app.chat.session_merge.create",m="kustomer.customer.delete",y="user-typing",w="user-typing-ended",O="ai-assistant-user-typing",_="customer-typing-ended",j="customer-typing"},9860:function(t,e,n){"use strict";n.d(e,{t0:function(){return r},u$:function(){return i},u9:function(){return o}});var r=function(t,e){return"ext-convo-group-".concat(e,".cust-").concat(t)},o=function(t,e){return"ext-meta-cust-".concat(e,".cust-").concat(t)},i=function(t,e){return"shrd-cust-".concat(e,".cust-").concat(t)}},9591:function(t,e,n){"use strict";n.d(e,{F6:function(){return h},Jt:function(){return p},bE:function(){return b},hl:function(){return d},yJ:function(){return g}});var r=n(3566),o=n(4552),i=n(9238),a=n(7289),u=n(5564);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f=function(t){if("No Content"!==t.statusText){var e=t.headers.get("content-type");return e&&e.includes("application/json")?t.ok?null==t?void 0:t.json():function(t){return t.json().then((function(e){var n=function(t){var e,n,r=t[0],o=null==r||null===(e=r.meta)||void 0===e||null===(n=e.subErrors)||void 0===n?void 0:n[0],i=r.title,a=r.code,u=r.source;if(o){var c=o.title;return{code:o.code,title:c,source:o.source.pointer}}return{source:(null==u?void 0:u.parameter)||(null==u?void 0:u.pointer),title:i,code:a}}(e.errors),r="".concat(null==t?void 0:t.status," ").concat(null==t?void 0:t.statusText," to ").concat(null==t?void 0:t.url);"badparam"===n.code&&(r="".concat(null==n?void 0:n.title,": ").concat(null==n?void 0:n.source));var o=new Error(r);throw o.title=null==n?void 0:n.title,o.status=t.status?"".concat(t.status):"",o.source=null==n?void 0:n.source,o.url=null==t?void 0:t.url,o.type=null==t?void 0:t.type,o}))}(t):null}},d=function(t,e){return fetch(t,{method:"POST",body:e}).then((function(t){return f(t)}))},v=function(t,e){var n,c=(0,a._)(),l=c.protocol,d=c.orgName,v=c.baseUrlDomain;if(void 0===d)return Promise.reject(new Error("Missing org"));var p=(0,o.KA)(),b=null==p||null===(n=p.settings)||void 0===n?void 0:n.enabled,g=[i.B];if(!1===b&&!g.includes(t))return Promise.reject(new Error("Could not complete request because Kustomer Chat is disabled in your org settings"));var h="".concat(l,"://").concat(d,".").concat(v).concat(t),m=function(t){var e=(0,r.Fb)()||"",n=new Headers({"Content-Type":"application/json","x-kustomer":"kustomer","x-kustomer-client":"chat-web","x-kustomer-tracking-token":e,credentials:"include"});return s(s({},t),{},{headers:n})}(e),y=(0,u.SQ)(t,null==e?void 0:e.method);return null!=e&&e.ignoreTracking||(0,u._s)({name:y}),fetch(h,m).then((function(t){return f(t)})).finally((function(){null!=e&&e.ignoreTracking||(0,u.wb)({name:y})}))},p=function(t,e){var n=s({method:"GET"},e);return v(t,n)},b=function(t,e){var n=s({method:"POST"},e);return v(t,n)},g=function(t,e){var n=s({method:"PUT"},e);return v(t,n)},h=function(t,e){var n=s({method:"PATCH"},e);return v(t,n)}},991:function(t,e,n){"use strict";n.d(e,{b:function(){return r}});var r=function(t){var e=t.id,n=t.attributes;return{conversationId:e,createdAt:n.createdAt,ended:!!n.lockedAt}}},3064:function(t,e,n){"use strict";n.d(e,{$:function(){return r},u:function(){return o}});var r=function(t){var e=t.attributes,n=e.htmlBody,r=e.metaDescription,o=e.title,i=e.article,a=e.updatedAt,u=e.lang,c=e.slug,s=e.hash,l=e.kbUrl,f=e.knowledgeBaseId;return{articleId:"string"==typeof i?i:null==i?void 0:i._id,htmlBody:n,title:o,description:r,updatedAt:a,lang:u,slug:c,hash:s,version:t.id,kbUrl:l,knowledgeBaseId:f}},o=function(t){return{articles:t}}},9774:function(t,e,n){"use strict";n.d(e,{r:function(){return u},y:function(){return a}});var r=n(6866),o=n(3041),i=n(4552),a=function(t){if(!t)return new Error("A conversationId must be provided.")},u=function(t){var e=(0,i.rd)(),n={total:e.total,change:{conversationId:t,count:e.conversations[t]}};(0,o.M)(r.rr,n)}},4516:function(t,e,n){"use strict";n.d(e,{e:function(){return c}});var r=n(4552),o=n(3064);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c=function(t,e,n){var i,u,c,s,l,f,d,v=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pubnub",p=null==n?void 0:n.find((function(t){return"user"===t.type})),b=null==p?void 0:p.attributes;if(b){var g=null==p?void 0:p.id;(0,r.dz)(g,b)}else{var h,m,y;b=(0,r.np)(null==t||null===(h=t.relationships)||void 0===h||null===(m=h.sentBy)||void 0===m||null===(y=m.data)||void 0===y?void 0:y.id)}var w,O=null==n?void 0:n.find((function(t){return"template"===t.type})),_=null==n||null===(i=n.filter((function(t){return"article"===t.type})))||void 0===i?void 0:i.map(o.$),j=t.id,P=t.attributes,I=t.relationships;null!=e&&e.length&&(w=e.map((function(t){return function(t){var e=t.links.related,n=t.id,r=t.attributes;return{url:e,attachmentId:n,contentLength:r.contentLength,contentType:r.contentType,name:r.name}}(t)})));var k=P.appGenerated,A=P.auto,S=P.body,E=P.bodyOverride,C=P.createdAt,D=P.direction,M=P.directionType,N=P.titleOverride,T=P.meta,$=I.session.data.id,F=null===(u=I.sentBy)||void 0===u||null===(c=u.data)||void 0===c?void 0:c.type,x=null===(s=I.sentBy)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.id,B=null===(f=b)||void 0===f?void 0:f.displayName,U=null===(d=b)||void 0===d?void 0:d.avatarUrl;return{appGenerated:k,messageId:j,body:S,createdAt:C,direction:D,directionType:M,conversationId:$,attachments:w,isInAssistantMode:Boolean(null==T?void 0:T.assistant),meta:{template:O&&a(a({},null==O?void 0:O.attributes),{},{id:null==O?void 0:O.id}),articles:_},notificationOverrides:{bodyOverride:E,titleOverride:N},sentBy:{type:A?"user":F,id:x,displayName:B,avatarUrl:U},source:v}}},4552:function(t,e,n){"use strict";n.d(e,{KA:function(){return l},NT:function(){return g},Y_:function(){return p},cO:function(){return d},cZ:function(){return y},dz:function(){return O},ez:function(){return j},fF:function(){return f},kk:function(){return b},kw:function(){return v},np:function(){return _},rd:function(){return w},yj:function(){return m}});var r=n(2838);function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c={listeners:{},sessions:{},unreadCounts:{conversations:{},total:0},users:{}},s=c,l=function(){return s},f=function(t,e){s=a(a({},s),{},u({},t,e))},d=function(t,e){var n,r=s.listeners[t]||[];s=a(a({},s),{},{listeners:a(a({},s.listeners),{},u({},t,[].concat((n=r,function(t){if(Array.isArray(t))return o(t)}(n)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[e])))})},v=function(t,e){var n=s.listeners[t];null!=n&&n.length&&(s=a(a({},s),{},{listeners:a(a({},s.listeners),{},u({},t,n.filter((function(t){return t!==e}))))}))},p=function(t){s=a(a({},s),{},{sessions:a(a({},s.sessions),{},u({},t.id,t))})},b=function(t){var e;return null===(e=s.sessions)||void 0===e?void 0:e[t]},g=function(t){s=a(a({},s),{},{unreadCounts:t})},h=function(t,e,n){s=a(a({},s),{},{unreadCounts:{total:e,conversations:a(a({},s.unreadCounts.conversations),{},u({},t,n))}})},m=function(t){var e=s.unreadCounts.conversations[t],n=s.unreadCounts.total;h(t,n>0?n-e:0,0)},y=function(t){var e=s.unreadCounts.conversations[t]||0,n=s.unreadCounts.total||0;h(t,n+1,e+1)},w=function(){return s.unreadCounts},O=function(t,e){s=a(a({},s),{},{users:a(a({},s.users),{},u({},t,e))})},_=function(t){return s.users[t]},j=function(){f("customerId",void 0),f("externalId",void 0),f("email",void 0),f("verified",void 0),f("sessions",{}),f("users",{}),f("unreadCounts",c.unreadCounts),r.eI.clear()}},4601:function(t,e,n){"use strict";n.d(e,{H:function(){return u}});var r=n(3429);function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.message,o=e.tags;return console.error(n,t),(0,r.Cp)(t,{tags:i({errorBoundary:!1},o)})}},5564:function(t,e,n){"use strict";n.d(e,{Oc:function(){return g},_s:function(){return h},wb:function(){return m},SQ:function(){return p}});var r=n(7162),o=n(3566);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f,d=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),l(this,"events",[]),l(this,"runningTimers",new Map),setInterval((function(){n.pushData()}),3e3),this.orgName=e}var e,n;return e=t,n=[{key:"setOrgName",value:function(t){this.orgName=t}},{key:"pushData",value:function(){0!==this.events.length&&this.orgName&&(("kustomer"===this.orgName||this.orgName.startsWith("zzz-")||this.orgName.startsWith("mikerapin"))&&function(t,e){if(!e)return Promise.reject(new Error("Missing org"));var n=(0,r.IZ)(),i=n.protocol,u=n.baseUrlDomain,c={body:t,method:"POST"},s="".concat(i,"://").concat(e,".").concat(u).concat("/c/v1/chat-events"),l=function(t){var e=(0,o.Fb)()||"",n=new Headers({"Content-Type":"application/json","x-kustomer":"kustomer","x-kustomer-client":"chat-web","x-kustomer-tracking-token":e,credentials:"include"});return a(a({},t),{},{headers:n})}(c);fetch(s,l)}(JSON.stringify(this.events),this.orgName),this.events=[])}},{key:"createEvent",value:function(t){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({surface:"web",timestamp:Date.now()},t)}},{key:"countEvent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e<1||this.events.push(this.createEvent({context:n,count:e,name:t}))}},{key:"timeEventStart",value:function(t){this.runningTimers.set(t,Date.now())}},{key:"timeEventStop",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.runningTimers.has(t)||console.error("There is no timer event being tracked with name: ".concat(t));var n=this.runningTimers.get(t);this.events.push(this.createEvent({name:t,duration:Date.now()-n,context:e}))}}],n&&s(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),v=function(t){if(!t)return"";try{var e=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(window.atob(e).split("").map((function(t){return"%".concat("00".concat(t.charCodeAt(0).toString(16)).slice(-2))})).join(""));return JSON.parse(n)}catch(t){return""}},p=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=t.substring(1,t.indexOf("?")>-1?t.indexOf("?"):t.length).replaceAll(/[0-9a-z]{24}\/?/g,"").replaceAll("/","_").replaceAll(/[,|.]/g,"").replace(/_$/g,""),r=e.toLowerCase();return"api.".concat(r,".").concat(n,".timer")},b=function(t){return f||(f=new d(t)),!f.orgName&&t&&f.setOrgName(t),f},g=function(t){var e=t.name,n=t.count,r=void 0===n?1:n,o=t.context,i=t.apiKey,a=i?v(i).orgName:null;b(a).countEvent(e,r,o)},h=function(t){var e=t.name,n=t.apiKey,r=n?v(n).orgName:null;b(r).timeEventStart(e)},m=function(t){var e=t.name,n=t.context,r=t.apiKey,o=r?v(r).orgName:null;b(o).timeEventStop(e,n)}},3429:function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(){return Promise.all([n.e("vendors-node_modules_sentry_utils_esm_misc_js-node_modules_sentry_utils_esm_normalize_js-node-4b6837"),n.e("sentry")]).then(n.bind(n,3126))}function i(t,e){return Promise.all([o(),Promise.all([n.e("vendors-node_modules_sentry_utils_esm_misc_js-node_modules_sentry_utils_esm_normalize_js-node-4b6837"),n.e("sentryHttpClient")]).then(n.bind(n,7284))]).then((function(n){var o,i,a=(i=2,function(t){if(Array.isArray(t))return t}(o=n)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(o,i)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(o,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=a[0],c=a[1].HttpClient;return u.getCurrentHub().getClient()||u.init({dsn:"https://".concat(t,"@o38471.ingest.sentry.io/6150287"),environment:"production",release:"release-v0.1.388",initialScope:{tags:{orgId:e}},beforeSend:function(t){var e,n;return null!==(e=t.exception)&&void 0!==e&&null!==(n=e.values)&&void 0!==n&&n.length&&!t.exception.values[0].stacktrace?null:t},integrations:[new c({failedRequestStatusCodes:[400,599]})],ignoreErrors:["TypeError: Failed to fetch","TypeError: NetworkError when attempting to fetch resource.","TypeError: cancelled","TypeError: Abgebrochen","TypeError: Kumottu","TypeError: annullato","TypeError: annulleret","TypeError: avbrutt","TypeError: geannuleerd","TypeError: poništeno","TypeError: vazgeçildi","TypeError: visszavonva","TypeError: скасовано","TypeError: ถูกยกเลิก","TypeError: キャンセルしました","TypeError: 已取消","TypeError: 취소됨"]}),u}))}function a(t,e){return o().then((function(n){return n.captureException(t,e)}))}n.d(e,{Cp:function(){return a},ig:function(){return i}})},3566:function(t,e,n){"use strict";n.d(e,{Fb:function(){return o},KI:function(){return r},NS:function(){return i},fC:function(){return a}});var r=function(t){try{localStorage.setItem("kustomer-chat-tracking-token",t)}catch(t){throw new Error("Setting tracking token in local storage")}},o=function(){try{return localStorage.getItem("kustomer-chat-tracking-token")}catch(t){throw new Error("Getting tracking token from local storage")}},i=function(){try{return localStorage.removeItem("kustomer-chat-tracking-token")}catch(t){throw new Error("Removing tracking token from local storage")}},a=function(){var t=window.navigator.userAgent.toLowerCase();return!!/iphone|ipod|ipad/.test(t)&&"standalone"in window.navigator&&window.navigator.standalone}},3182:function(t,e,n){"use strict";n.d(e,{A0:function(){return c}});var r=n(1605),o=n(2997),i=n(9696),a=(n(7715),function(){var t,e=window.navigator;return(0,r.TJ)()?null==e?void 0:e.browserLanguage:null==e||null===(t=e.languages)||void 0===t?void 0:t[0]}),u=function(t){var e=t.toLowerCase(),n=e.replace("-","_");return-1===n.indexOf("_")?e:i.Y[n]?n:n.split("_")[0]},c=function(t){var e,n;if(t)return i.Y[t];var r=null===(e=(0,o.n2)())||void 0===e||null===(n=e.startParameters)||void 0===n?void 0:n.lang,c=r&&"string"==typeof r&&u(r);if(c&&i.Y[c])return i.Y[c];var s=u(a());return i.Y[s]}},9696:function(t,e,n){"use strict";n.d(e,{Y:function(){return r}});var r={af:"af",ar:"ar",be:"be",bg:"bg",bs:"bs",ca:"ca",he:"he",cs:"cs",da:"da",de:"de",nl:"nl",el:"el",en:"en_us",en_us:"en_us",en_ca:"en_ca",en_gb:"en_gb",es:"es",es_es:"es_es",et:"et",fi:"fi",fil:"fil",fr:"fr",fr_ca:"fr_ca",hi:"hi",hr:"hr",hu:"hu",id:"id",is:"is",it:"it",ja:"ja",ka:"ka",kk:"kk",kn:"kn",ko:"ko",ky:"ky",lt:"lt",lv:"lv",no:"no",pa:"pa",pl:"pl",pt:"pt",pt_br:"pt_br",ro:"ro",ru:"ru",sk:"sk",sl:"sl",sq:"sq",sr:"sr",sv:"sv",sw:"sw",te:"te",th:"th",tr:"tr",tw:"zh_tw",uk:"uk",ur:"ur",uz:"uz",vi:"vi",zh:"zh_cn",zh_cn:"zh_cn",zh_tw:"zh_tw"}},7715:function(t,e,n){},1605:function(t,e,n){"use strict";n.d(e,{TJ:function(){return r},sD:function(){return o}});var r=function(){var t=window.navigator.userAgent;return t.indexOf("MSIE")>0||t.indexOf("Trident")>0},o=function(){return r()?Promise.all([n.e("intl-relativetimeformat"),n.e("vendors-node_modules_formatjs_intl-getcanonicallocales_polyfill_js-node_modules_formatjs_intl-64af64"),n.e("polyfills")]).then(n.bind(n,676)).catch((function(t){return"An error occurred while loading polyfills, ".concat(t)})):Promise.resolve()}},2997:function(t,e,n){"use strict";n.d(e,{n2:function(){return r}});var r=function(){return window.parent.Kustomer}},4353:function(t){t.exports=function(){"use strict";var t=6e4,e=36e5,n="millisecond",r="second",o="minute",i="hour",a="day",u="week",c="month",s="quarter",l="year",f="date",d="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,b={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},g=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},h={s:g,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),o=n%60;return(e<=0?"+":"-")+g(r,2,"0")+":"+g(o,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),o=e.clone().add(r,c),i=n-o<0,a=e.clone().add(r+(i?-1:1),c);return+(-(r+(n-o)/(i?o-a:a-o))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:c,y:l,w:u,d:a,D:f,h:i,m:o,s:r,ms:n,Q:s}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},m="en",y={};y[m]=b;var w=function(t){return t instanceof P},O=function(t,e,n){var r;if(!t)return m;if("string"==typeof t)y[t]&&(r=t),e&&(y[t]=e,r=t);else{var o=t.name;y[o]=t,r=o}return!n&&r&&(m=r),r||!n&&m},_=function(t,e){if(w(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new P(n)},j=h;j.l=O,j.i=w,j.w=function(t,e){return _(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var P=function(){function b(t){this.$L=O(t.locale,null,!0),this.parse(t)}var g=b.prototype;return g.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(j.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(v);if(r){var o=r[2]-1||0,i=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)):new Date(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},g.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},g.$utils=function(){return j},g.isValid=function(){return!(this.$d.toString()===d)},g.isSame=function(t,e){var n=_(t);return this.startOf(e)<=n&&n<=this.endOf(e)},g.isAfter=function(t,e){return _(t)<this.startOf(e)},g.isBefore=function(t,e){return this.endOf(e)<_(t)},g.$g=function(t,e,n){return j.u(t)?this[e]:this.set(n,t)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(t,e){var n=this,s=!!j.u(e)||e,d=j.p(t),v=function(t,e){var r=j.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return s?r:r.endOf(a)},p=function(t,e){return j.w(n.toDate()[t].apply(n.toDate("s"),(s?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},b=this.$W,g=this.$M,h=this.$D,m="set"+(this.$u?"UTC":"");switch(d){case l:return s?v(1,0):v(31,11);case c:return s?v(1,g):v(0,g+1);case u:var y=this.$locale().weekStart||0,w=(b<y?b+7:b)-y;return v(s?h-w:h+(6-w),g);case a:case f:return p(m+"Hours",0);case i:return p(m+"Minutes",1);case o:return p(m+"Seconds",2);case r:return p(m+"Milliseconds",3);default:return this.clone()}},g.endOf=function(t){return this.startOf(t,!1)},g.$set=function(t,e){var u,s=j.p(t),d="set"+(this.$u?"UTC":""),v=(u={},u[a]=d+"Date",u[f]=d+"Date",u[c]=d+"Month",u[l]=d+"FullYear",u[i]=d+"Hours",u[o]=d+"Minutes",u[r]=d+"Seconds",u[n]=d+"Milliseconds",u)[s],p=s===a?this.$D+(e-this.$W):e;if(s===c||s===l){var b=this.clone().set(f,1);b.$d[v](p),b.init(),this.$d=b.set(f,Math.min(this.$D,b.daysInMonth())).$d}else v&&this.$d[v](p);return this.init(),this},g.set=function(t,e){return this.clone().$set(t,e)},g.get=function(t){return this[j.p(t)]()},g.add=function(n,s){var f,d=this;n=Number(n);var v=j.p(s),p=function(t){var e=_(d);return j.w(e.date(e.date()+Math.round(t*n)),d)};if(v===c)return this.set(c,this.$M+n);if(v===l)return this.set(l,this.$y+n);if(v===a)return p(1);if(v===u)return p(7);var b=(f={},f[o]=t,f[i]=e,f[r]=1e3,f)[v]||1,g=this.$d.getTime()+n*b;return j.w(g,this)},g.subtract=function(t,e){return this.add(-1*t,e)},g.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||d;var r=t||"YYYY-MM-DDTHH:mm:ssZ",o=j.z(this),i=this.$H,a=this.$m,u=this.$M,c=n.weekdays,s=n.months,l=function(t,n,o,i){return t&&(t[n]||t(e,r))||o[n].substr(0,i)},f=function(t){return j.s(i%12||12,t,"0")},v=n.meridiem||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r},b={YY:String(this.$y).slice(-2),YYYY:this.$y,M:u+1,MM:j.s(u+1,2,"0"),MMM:l(n.monthsShort,u,s,3),MMMM:l(s,u),D:this.$D,DD:j.s(this.$D,2,"0"),d:String(this.$W),dd:l(n.weekdaysMin,this.$W,c,2),ddd:l(n.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(i),HH:j.s(i,2,"0"),h:f(1),hh:f(2),a:v(i,a,!0),A:v(i,a,!1),m:String(a),mm:j.s(a,2,"0"),s:String(this.$s),ss:j.s(this.$s,2,"0"),SSS:j.s(this.$ms,3,"0"),Z:o};return r.replace(p,(function(t,e){return e||b[t]||o.replace(":","")}))},g.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},g.diff=function(n,f,d){var v,p=j.p(f),b=_(n),g=(b.utcOffset()-this.utcOffset())*t,h=this-b,m=j.m(this,b);return m=(v={},v[l]=m/12,v[c]=m,v[s]=m/3,v[u]=(h-g)/6048e5,v[a]=(h-g)/864e5,v[i]=h/e,v[o]=h/t,v[r]=h/1e3,v)[p]||h,d?m:j.a(m)},g.daysInMonth=function(){return this.endOf(c).$D},g.$locale=function(){return y[this.$L]},g.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=O(t,e,!0);return r&&(n.$L=r),n},g.clone=function(){return j.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},b}(),I=P.prototype;return _.prototype=I,[["$ms",n],["$s",r],["$m",o],["$H",i],["$W",a],["$M",c],["$y",l],["$D",f]].forEach((function(t){I[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),_.extend=function(t,e){return t.$i||(t(e,P,_),t.$i=!0),_},_.locale=O,_.isDayjs=w,_.unix=function(t){return _(1e3*t)},_.en=y[m],_.Ls=y,_.p={},_}()},6762:function(t,e,n){var r,o="__lodash_hash_undefined__",i=1/0,a="[object Function]",u="[object GeneratorFunction]",c="[object Symbol]",s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,l=/^\w*$/,f=/^\./,d=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,v=/\\(\\)?/g,p=/^\[object .+?Constructor\]$/,b="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,g="object"==typeof self&&self&&self.Object===Object&&self,h=b||g||Function("return this")(),m=Array.prototype,y=Function.prototype,w=Object.prototype,O=h["__core-js_shared__"],_=(r=/[^.]+$/.exec(O&&O.keys&&O.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",j=y.toString,P=w.hasOwnProperty,I=w.toString,k=RegExp("^"+j.call(P).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),A=h.Symbol,S=m.splice,E=B(h,"Map"),C=B(Object,"create"),D=A?A.prototype:void 0,M=D?D.toString:void 0;function N(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function T(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function $(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function F(t,e){for(var n,r,o=t.length;o--;)if((n=t[o][0])===(r=e)||n!=n&&r!=r)return o;return-1}function x(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function B(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return function(t){if(!z(t)||_&&_ in t)return!1;var e=function(t){var e=z(t)?I.call(t):"";return e==a||e==u}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?k:p;return e.test(function(t){if(null!=t){try{return j.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}(n)?n:void 0}N.prototype.clear=function(){this.__data__=C?C(null):{}},N.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},N.prototype.get=function(t){var e=this.__data__;if(C){var n=e[t];return n===o?void 0:n}return P.call(e,t)?e[t]:void 0},N.prototype.has=function(t){var e=this.__data__;return C?void 0!==e[t]:P.call(e,t)},N.prototype.set=function(t,e){return this.__data__[t]=C&&void 0===e?o:e,this},T.prototype.clear=function(){this.__data__=[]},T.prototype.delete=function(t){var e=this.__data__,n=F(e,t);return!(n<0||(n==e.length-1?e.pop():S.call(e,n,1),0))},T.prototype.get=function(t){var e=this.__data__,n=F(e,t);return n<0?void 0:e[n][1]},T.prototype.has=function(t){return F(this.__data__,t)>-1},T.prototype.set=function(t,e){var n=this.__data__,r=F(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},$.prototype.clear=function(){this.__data__={hash:new N,map:new(E||T),string:new N}},$.prototype.delete=function(t){return x(this,t).delete(t)},$.prototype.get=function(t){return x(this,t).get(t)},$.prototype.has=function(t){return x(this,t).has(t)},$.prototype.set=function(t,e){return x(this,t).set(t,e),this};var U=K((function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(L(t))return M?M.call(t):"";var e=t+"";return"0"==e&&1/t==-i?"-0":e}(e);var n=[];return f.test(t)&&n.push(""),t.replace(d,(function(t,e,r,o){n.push(r?o.replace(v,"$1"):e||t)})),n}));function H(t){if("string"==typeof t||L(t))return t;var e=t+"";return"0"==e&&1/t==-i?"-0":e}function K(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=t.apply(this,r);return n.cache=i.set(o,a),a};return n.cache=new(K.Cache||$),n}K.Cache=$;var J=Array.isArray;function z(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function L(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&I.call(t)==c}t.exports=function(t,e,n){var r=null==t?void 0:function(t,e){var n;e=function(t,e){if(J(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!L(t))||l.test(t)||!s.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:J(n=e)?n:U(n);for(var r=0,o=e.length;null!=t&&r<o;)t=t[H(e[r++])];return r&&r==o?t:void 0}(t,e);return void 0===r?n:r}}},i={};function a(t){var e=i[t];if(void 0!==e)return e.exports;var n=i[t]={id:t,loaded:!1,exports:{}};return o[t].call(n.exports,n,n.exports,a),n.loaded=!0,n.exports}a.m=o,a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,{a:e}),e},e=Object.getPrototypeOf?function(t){return Object.getPrototypeOf(t)}:function(t){return t.__proto__},a.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var o=Object.create(null);a.r(o);var i={};t=t||[null,e({}),e([]),e(e)];for(var u=2&r&&n;"object"==typeof u&&!~t.indexOf(u);u=e(u))Object.getOwnPropertyNames(u).forEach((function(t){i[t]=function(){return n[t]}}));return i.default=function(){return n},a.d(o,i),o},a.d=function(t,e){for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.f={},a.e=function(t){return Promise.all(Object.keys(a.f).reduce((function(e,n){return a.f[n](t,e),e}),[]))},a.u=function(t){return t+"."+{"intl-relativetimeformat":"67f935f6643dd7681954","vendors-node_modules_formatjs_intl-getcanonicallocales_polyfill_js-node_modules_formatjs_intl-64af64":"fca424e6159064bb0df8",polyfills:"26fe769f4a11fd8286ee","vendors-node_modules_sentry_utils_esm_misc_js-node_modules_sentry_utils_esm_normalize_js-node-4b6837":"279bbcc09f572c9d5276",sentry:"8163a1bccabd1df4c646",sentryHttpClient:"b27b3227667f7008a97b",locale_en:"0d3e1e615c873506bf58",lang_es:"b6f7533639b7564689ac",locale_es:"c57261f66f8244a0a3bc",lang_fr:"40617f54a64528e5640a",locale_fr:"68f15e3bfbb80f5200e9",lang_de:"b73bf24a6d305a8f0f25",locale_de:"03f0a824ca6931c15528",lang_pt:"81a97a51234732587f45",locale_pt:"f8fa11b6a2c657f43152",lang_ar:"3dbac5a917b872563266",locale_ar:"7f9eef122046800007d4",lang_he:"aefef2a2bf23b7b1b49e",locale_he:"ebc014ae89195619ac0c",lang_af:"4cdb49bde4d4b07ea5bf",loclae_af:"d1e3f8f9ed36702f1548",lang_be:"3407eb9cbfb229324122",locale_be:"70e03dcc18e5aa34b1d8",lang_bg:"107a2a39bdff2e86d191",locale_bg:"e1affff4f8deb47d5a45",lang_bs:"6dba49e94db922ffb0dc",locale_bs:"2509bab8a874677b2a49",lang_ca:"426d457f17d1e352a137",locale_ca:"ce78926b74524d6ebcf0",lang_cs:"d171cee43a41c5fb9458",locale_cs:"a45eccc3845e08d8e750",lang_da:"86fdf162121fc0669a1c",locale_da:"20392eb427281fa08efa",lang_nl:"64cf83a4e0afaa596a76",locale_nl:"77d362feda67bb6ac76d",lang_el:"1dec4ddd22e1598da69d",locale_el:"64940041883b730c22b5",lang_et:"f34ae967aab427925cb1",locale_et:"506df51aaa4b520de0a3",lang_fi:"b46e0b69d6e99d1dff0d",locale_fi:"26f0cd103f1172f021ce",lang_fil:"edb46e0360bf59d2cc5f",locale_fil:"8d3e43d60d0b5fad8369",lang_hi:"7384da3da51613a2b907",locale_hi:"2a4f05a231f85657ab55",lang_hr:"f00e999a9020970b38cb",locale_hr:"e23fa4460f899e7e8f23",lang_hu:"0f70b39f594b84d42f75",locale_hu:"9c8b03ef0c602c134dfd",lang_id:"a1c85c701ad16892299b",locale_id:"1d9cc4cf5afbc41c8420",lang_is:"3b05ac85bb3aa1f6ce03",locale_is:"f5f909dcd054d3b9aaea",lang_it:"9eb7ee95387791cb22b3",locale_it:"18c427cda56f0fd838d9",lang_ja:"371ff1ba62cbfd04af71",locale_ja:"c3f95b6bd8fc2e0acee8",lang_ka:"2009bddd2da24e7cbe29",locale_ka:"e358b7309752122d04d6",lang_kk:"a21c614e726abff74771",locale_kk:"ab6f0e928f680d87129c",lang_kn:"736d40414fa77a8bb4c0",locale_kn:"5657b2620effbc912e69",lang_ko:"13a6358a9af2b5667f64",locale_ko:"2eab1fb8470006f78716",lang_ky:"489d5ab6b8b8e2ef79a4",locale_ky:"2f52d2e187d44e1b1cac",lang_lt:"aecf63453de17336aaf7",locale_lt:"51a53ad301ea28e35514",lang_lv:"5cdc5c5c8989f0363865",locale_lv:"7e8afa694caf44845962",lang_no:"69bb72ac2b4747bd0be9",lang_pa:"47cfff3b63de6dfd5f84",locale_pa:"59895df9c5bfe359ccaf",lang_pl:"61fa604280af58238f46",locale_pl:"cb9e9706ee282fb57003",lang_pt_br:"1fe9783b891ba20ace64",lang_ro:"c7441b70667aa509dc07",locale_ro:"668157511fb3271f93e3",lang_ru:"98385fe0faa01df8f3ac",locale_ru:"4f9ec23dc0c129a8fd1d",lang_sk:"61312e5ab0f0c4a9429d",locale_sk:"d6d46112477f1d312ccd",lang_sl:"65d33eeaa5181e952844",locale_sl:"27e56c683f6d1d768ee4",lang_sq:"29d78c3de46f7c7f4e2c",locale_sq:"47904077fcec9b6d99dd",lang_sr:"c696fb8f068150d4c407",locale_sr:"6a5b1b9880dc0fdd5963",lang_sv:"3487f0966581894900d7",locale_sv:"de861debb6adaf0b6757",lang_sw:"758f24d91645e02a698f",locale_sw:"15008b7dc825f0967ca7",lang_te:"cbb75719c27aa9000052",locale_te:"c5818095f0621198465e",lang_th:"6da6ec4d8c0320fbb43e",locale_th:"f11679ec63b1eb6a3b76",lang_tr:"d8a9137c17f5eed17e4b",locale_tr:"9818212226ae217fe57f",lang_tw:"8241c789e53e8d9488ee",locale_ak:"963b6c22084b28390a44",lang_uk:"76c1976768dcc1ec65ed",locale_uk:"cd754a6b5dd3d203cede",lang_ur:"e6149595dc8b16124506",locale_ur:"f163adacdb847a32acf0",lang_uz:"305f30b1a44c1f8692d7",locale_uz:"13abca0a0cdcf4cd1f95",lang_vi:"fb20ec5bfa74d6a0406f",locale_vi:"47d917513b2ba51ec675",lang_zh_cn:"726157b954160b810bfa","vendors-node_modules_pubnub_dist_web_pubnub_min_js":"533ef2662a4c60ed20ea",pubnub:"ef422f24bee8cb63c900"}[t]+".js"},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),a.hmd=function(t){return(t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n={},r="chat-web:",a.l=function(t,e,o,i){if(n[t])n[t].push(e);else{var u,c;if(void 0!==o)for(var s=document.getElementsByTagName("script"),l=0;l<s.length;l++){var f=s[l];if(f.getAttribute("src")==t||f.getAttribute("data-webpack")==r+o){u=f;break}}u||(c=!0,(u=document.createElement("script")).charset="utf-8",u.timeout=120,a.nc&&u.setAttribute("nonce",a.nc),u.setAttribute("data-webpack",r+o),u.src=t),n[t]=[e];var d=function(e,r){u.onerror=u.onload=null,clearTimeout(v);var o=n[t];if(delete n[t],u.parentNode&&u.parentNode.removeChild(u),o&&o.forEach((function(t){return t(r)})),e)return e(r)},v=setTimeout(d.bind(null,void 0,{type:"timeout",target:u}),12e4);u.onerror=d.bind(null,u.onerror),u.onload=d.bind(null,u.onload),c&&document.head.appendChild(u)}},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.p="https://cdn.kustomerapp.com/chat-web/release-v0.1.388/",function(){var t={"core-main":0};a.f.j=function(e,n){var r=a.o(t,e)?t[e]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise((function(n,o){r=t[e]=[n,o]}));n.push(r[2]=o);var i=a.p+a.u(e),u=new Error;a.l(i,(function(n){if(a.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;u.message="Loading chunk "+e+" failed.\n("+o+": "+i+")",u.name="ChunkLoadError",u.type=o,u.request=i,r[1](u)}}),"chunk-"+e,e)}};var e=function(e,n){var r,o,i=n[0],u=n[1],c=n[2],s=0;if(i.some((function(e){return 0!==t[e]}))){for(r in u)a.o(u,r)&&(a.m[r]=u[r]);c&&c(a)}for(e&&e(n);s<i.length;s++)o=i[s],a.o(t,o)&&t[o]&&t[o][0](),t[o]=0},n=self.webpackChunkchat_web=self.webpackChunkchat_web||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}(),function(){"use strict";var t=function(t){var e=this.constructor;return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){return e.reject(n)}))}))},e=function(t){return new this((function(e,n){if(!t||void 0===t.length)return n(new TypeError(typeof t+" "+t+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var r=Array.prototype.slice.call(t);if(0===r.length)return e([]);var o=r.length;function i(t,n){if(n&&("object"==typeof n||"function"==typeof n)){var a=n.then;if("function"==typeof a)return void a.call(n,(function(e){i(t,e)}),(function(n){r[t]={status:"rejected",reason:n},0==--o&&e(r)}))}r[t]={status:"fulfilled",value:n},0==--o&&e(r)}for(var a=0;a<r.length;a++)i(a,r[a])}))},n=setTimeout,r="undefined"!=typeof setImmediate?setImmediate:null;function o(t){return Boolean(t&&void 0!==t.length)}function i(){}function u(t){if(!(this instanceof u))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],v(t,this)}function c(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,u._immediateFn((function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(t){return void l(e.promise,t)}s(e.promise,r)}else(1===t._state?s:l)(e.promise,t._value)}))):t._deferreds.push(e)}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof u)return t._state=3,t._value=e,void f(t);if("function"==typeof n)return void v((r=n,o=e,function(){r.apply(o,arguments)}),t)}t._state=1,t._value=e,f(t)}catch(e){l(t,e)}var r,o}function l(t,e){t._state=2,t._value=e,f(t)}function f(t){2===t._state&&0===t._deferreds.length&&u._immediateFn((function(){t._handled||u._unhandledRejectionFn(t._value)}));for(var e=0,n=t._deferreds.length;e<n;e++)c(t,t._deferreds[e]);t._deferreds=null}function d(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function v(t,e){var n=!1;try{t((function(t){n||(n=!0,s(e,t))}),(function(t){n||(n=!0,l(e,t))}))}catch(t){if(n)return;n=!0,l(e,t)}}u.prototype.catch=function(t){return this.then(null,t)},u.prototype.then=function(t,e){var n=new this.constructor(i);return c(this,new d(t,e,n)),n},u.prototype.finally=t,u.all=function(t){return new u((function(e,n){if(!o(t))return n(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(t);if(0===r.length)return e([]);var i=r.length;function a(t,o){try{if(o&&("object"==typeof o||"function"==typeof o)){var u=o.then;if("function"==typeof u)return void u.call(o,(function(e){a(t,e)}),n)}r[t]=o,0==--i&&e(r)}catch(t){n(t)}}for(var u=0;u<r.length;u++)a(u,r[u])}))},u.allSettled=e,u.resolve=function(t){return t&&"object"==typeof t&&t.constructor===u?t:new u((function(e){e(t)}))},u.reject=function(t){return new u((function(e,n){n(t)}))},u.race=function(t){return new u((function(e,n){if(!o(t))return n(new TypeError("Promise.race accepts an array"));for(var r=0,i=t.length;r<i;r++)u.resolve(t[r]).then(e,n)}))},u._immediateFn="function"==typeof r&&function(t){r(t)}||function(t){n(t,0)},u._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var p=u,b=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==a.g)return a.g;throw new Error("unable to locate global object")}();"function"!=typeof b.Promise?b.Promise=p:(b.Promise.prototype.finally||(b.Promise.prototype.finally=t),b.Promise.allSettled||(b.Promise.allSettled=e))}(),function(){if("undefined"!=typeof window)try{var t=new window.CustomEvent("test",{cancelable:!0});if(t.preventDefault(),!0!==t.defaultPrevented)throw new Error("Could not prevent default")}catch(t){var e=function(t,e){var n,r;return(e=e||{}).bubbles=!!e.bubbles,e.cancelable=!!e.cancelable,(n=document.createEvent("CustomEvent")).initCustomEvent(t,e.bubbles,e.cancelable,e.detail),r=n.preventDefault,n.preventDefault=function(){r.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch(t){this.defaultPrevented=!0}},n};e.prototype=window.Event.prototype,window.CustomEvent=e}}(),function(){"use strict";var t=a(1605),e=a(9591),n=a(4552),r=a(3182),o=function(t){return(o=t.brandId,(0,e.Jt)(function(t){var e=null==t?void 0:t.brandId,n="/p/v1/chat/settings/versions/latest";return e&&(n="/p/v1/chat/brands/".concat(e,"/settings/versions/latest")),n}({brandId:o})).then((function(t){return null==t?void 0:t.data.attributes.settingsVersion})).catch((function(){}))).then((function(o){return(0,e.Jt)(function(t){var e=null==t?void 0:t.brandId,n=null==t?void 0:t.lang,o=null==t?void 0:t.settingsVersion,i="/p/v2/chat/settings";e&&(i="/p/v2/chat/brands/".concat(e,"/settings"));var a=(0,r.A0)(n),u=new URLSearchParams;n&&u.set("lang",a),void 0!==o&&u.set("settingsVersion",o.toString());var c=u.toString();return c.length&&(i="".concat(i,"?").concat(c)),i}({brandId:t.brandId,lang:t.lang,settingsVersion:o})).then((function(e){var r,o,i,a,u,c,s,l,f,d,v=e.data.attributes,p=v.assistantRules,b=v.botConsent,g=v.closableChat,h=v.colors,m=v.disableAttachments,y=v.domainCriteria,w=v.embedIconColor,O=v.embedIconUrl,_=v.enabled,j=v.greeting,P=v.noHistory,I=v.offhoursDisplay,k=v.offhoursImageUrl,A=v.offhoursMessage,S=v.outboundChatEnabled,E=v.sentry,C=v.sharedPubNubKeySet,D=v.showBotIdentifier,M=v.showBrandingIdentifier,N=v.showTypingIndicatorCustomerWeb,T=v.showTypingIndicatorWeb,$=v.singleSessionChat,F=v.teamIconUrl,x=v.teamName,B=v.volumeControl,U=v.waitMessage,H=v.widgetType,K=e.data.relationships.org.data.id,J=null==e||null===(r=e.data)||void 0===r||null===(o=r.relationships)||void 0===o||null===(i=o.brand)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.id,z=null==e||null===(u=e.data)||void 0===u||null===(c=u.relationships)||void 0===c||null===(s=c.kb)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.id,L=(null==t?void 0:t.assistantId)||(null==e||null===(f=e.data)||void 0===f||null===(d=f.attributes)||void 0===d?void 0:d.activeAssistant);return(0,n.fF)("settings",{activeAssistant:L,assistantRules:p,botConsent:b,brandId:J,closableChat:g,colors:h,disableAttachments:m,domainCriteria:y,embedIconColor:w,embedIconUrl:O,enabled:_,greeting:j,knowledgeBaseId:z,noHistory:P,offhoursDisplay:I,offhoursImageUrl:k,offhoursMessage:A,outboundChatEnabled:S,sentry:E,sharedPubNubKeySet:C,showBotIdentifier:D,showBrandingIdentifier:M,showTypingIndicatorCustomerWeb:N,showTypingIndicatorWeb:T,singleSessionChat:$,teamIconUrl:F,teamName:x,volumeControl:B,waitMessage:U,widgetType:H}),(0,n.fF)("orgId",K),e}))}));var o},i=a(3566),u=a(9238),c=a(7556),s=function(t){return Promise.all([a.e("vendors-node_modules_pubnub_dist_web_pubnub_min_js"),a.e("pubnub")]).then(a.bind(a,243)).then((function(e){if(!t)return e;var r=t.customerId,o=t.orgId,i=t.cb;return(0,n.KA)().isPubNubConnected?e:e.initializePubNub({customerId:r,orgId:o,cb:i}).then((function(){return e}))}))},l=a(4601),f=a(3429),d=function(){var t=(0,n.KA)().settings,e=t.embedIconUrl,r=t.embedIconColor,o=t.teamIconUrl,i=t.teamName,a=t.waitMessage,u=t.greeting,c=t.singleSessionChat,s=t.noHistory,l=t.disableAttachments,f=t.offhoursDisplay,d=t.offhoursImageUrl,v=t.offhoursMessage,p=t.closableChat,b=t.widgetType,g=t.activeAssistant,h=t.volumeControl,m=t.domainCriteria,y=t.colors,w=t.showBrandingIdentifier,O=t.brandId,_=t.knowledgeBaseId,j=t.assistantRules,P=t.sentry,I=t.botConsent,k=t.showBotIdentifier;return{settings:{embedIconUrl:e,embedIconColor:r,teamName:i,teamIconUrl:o,waitMessage:h.customWaitMessage||a,greeting:u,singleSessionChat:c,noHistory:s,disableAttachments:l,offhoursDisplay:f,offhoursImageUrl:d,offhoursMessage:v,closableChat:p,widgetType:b,activeAssistant:g,volumeControl:h,domainCriteria:m,colors:y,showBrandingIdentifier:w,brandId:O,knowledgeBaseId:_,assistantRules:j,sentry:P,botConsent:I,showBotIdentifier:k}}},v=function(t,r){var a,v,p,b,g=(0,i.Fb)();return Promise.all([o({brandId:null==t?void 0:t.brandId,lang:null==t?void 0:t.lang,assistantId:null==t?void 0:t.assistantId}),(a=null==t?void 0:t.scheduleId,b=a||(null===(v=(0,n.KA)())||void 0===v||null===(p=v.schedule)||void 0===p?void 0:p.id),(0,e.Jt)(function(t){return u.B.replace(":scheduleId",t||"default")}(b)).then((function(t){var e=t.included,r=t.data,o=r.id,i=r.attributes,a=i.hours,u=i.name,c=i.timezone,s=i.timezoneOffset;return(0,n.fF)("schedule",{id:o,hours:a,name:u,timezone:c,timezoneOffset:s,holidays:e}),t})))]).then((function(t){var e,o,a,u,l=null===(e=t[0])||void 0===e||null===(o=e.data)||void 0===o||null===(a=o.attributes)||void 0===a||null===(u=a.sentry)||void 0===u?void 0:u.web;if(l&&!(0,i.fC)()&&(0,f.ig)(l,(0,n.KA)().orgId),!(0,n.KA)().settings.enabled){var v="Kustomer Chat is disabled in your org settings. Initialization will not continue.";return console.warn(v),Promise.reject(new Error(v))}if(null!==g)return(0,c.u)().then((function(t){var e,o,i,a,u=null==t||null===(e=t.data)||void 0===e||null===(o=e.relationships)||void 0===o||null===(i=o.customer)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.id;if((0,n.fF)("customerId",u),void 0!==u){var c=(0,n.KA)().orgId,l=d();return s({customerId:u,orgId:c,cb:function(){"function"==typeof r&&r(l)}}).then((function(){return l}))}(0,n.fF)("isPubNubConnected",!1)}));(0,n.fF)("isPubNubConnected",!1)})).then((function(t){if(!t&&"function"==typeof r){var e=d();r(e)}})).catch((function(t){"function"==typeof r&&r(null,t),(0,l.H)(t,{message:"Failed to initialize"})}))},p=a(6649),b=a(6866),g=a(3041),h=a(4619),m=function(t,e){var n=t.conversationChannels;return function(t){var r=t.operation,o=t.affectedChannels,i=t.error,a=t.category;r===h.us&&(n.filter((function(t){return null==o?void 0:o.includes(t)})).length===n.length||i)&&e(null,i?a:null)}},y=a(6127),w=a(4516),O=function(t){if(t)return Object.entries(t).reduce((function(t,e){var n,r=e[0],o=e[1],i={};t&&(i=t);var a=null==o||null===(n=o.match(/(page=)([0-9]+)/g))||void 0===n?void 0:n[0];if("string"==typeof a){var u,c=null===(u=a.split("="))||void 0===u?void 0:u[1];a=Number.parseInt(c,10)}return i?("prev"===r?i.previous=a:"self"===r?i.current=a:i[r]=a,i):t}),{})},_=a(5506);function j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function P(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I(t){return function(t){if(Array.isArray(t))return k(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return k(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function A(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?A(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function E(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var C=function(t){var e=null==t?void 0:t.messages.map((function(t){return new Promise((function(e){var n,r,o;(null==t||null===(n=t.message)||void 0===n||null===(r=n.data)||void 0===r||null===(o=r.relationships)||void 0===o?void 0:o.attachments)?(0,y.ML)(t.message.data.id).then((function(n){e(S(S({},t),{},{attachments:n}))})):e(t)}))}));return Promise.allSettled(e).then((function(t){var e=[];return t.forEach((function(t){"rejected"!==t.status?e.push(t.value):(0,l.H)(t.reason,{message:"Error appending attachment(s) to PubNub message"})})),{messages:e}}))},D=function(t,e){var r,o=null==t?void 0:t.conversationId;return s().then((function(t){return r=t,function(t){var e=(0,n.kk)(t);return e?Promise.resolve(e):(0,p.Ht)(t).then((function(){return(0,n.kk)(t)}))}(o)})).then((function(t){var e,i,a,u,c=null==t||null===(e=t.attributes)||void 0===e||null===(i=e.pubnub)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.channels,s=(0,n.KA)(),f=s.settings,d=f.showTypingIndicatorCustomerWeb,v=f.showTypingIndicatorWeb,p=d||v;if(!c)throw new Error("Conversation PubNub channels not found");var g=c.find((function(t){return"conversation"===t.type}));if(!s.isPubNubConnected)return Promise.reject(new Error("PubNub isn't connected"));if(!g)return Promise.reject(new Error("No conversation channel found for conversation: ".concat(o)));var h=c.find((function(t){return"conversation"===t.type}));if(p&&h){var m,y,w=h.name.replace("ext-convo-","shrd-convo-");w.length&&(null===(m=r.getMetaPubNub())||void 0===m||null===(y=m.instance)||void 0===y||y.subscribe({channels:[w]}))}return function(t,e){return new Promise((function(n,r){e||r(new Error("PubNub instance not found")),function o(i){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.fetchMessages({channels:[t],start:i,count:b.ZW}).then((function(e){var r,i=(null==e||null===(r=e.channels)||void 0===r?void 0:r[t])||[],u=[].concat(I(a),I(i));if(null==i||!i.length||i.length<b.ZW)return n({messages:u});var c=i[0].timetoken;return o(c,u)})).catch((function(t){(0,l.H)(t,{message:"Failed to get messages from pubnub"}),r(t)}))}(0)}))}(g.name,null===(u=r.getConversationPubNub())||void 0===u?void 0:u.instance)})).then(C).then((function(t){var n=function(t,e){var n={satisfaction:{},messages:[]};return null!=t&&t.length&&(n=t.reduce((function(t,e){var n,r;if(e.message.name!==h.nV&&e.message.name!==h.gV||t.messages.push((0,w.e)(e.message.data,null==e||null===(n=e.attachments)||void 0===n?void 0:n.data,null==e||null===(r=e.message)||void 0===r?void 0:r.included,"pubnub")),e.message.name===h.UM||e.message.eventType===h.sX){var o,i,a=null==e||null===(o=e.message.included)||void 0===o?void 0:o.find((function(t){return"satisfaction"===t.type})),u=e.timetoken;t.satisfaction=(0,_.FQ)(null==e||null===(i=e.message)||void 0===i?void 0:i.data,u,a)}return t}),n)),function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?j(Object(n),!0).forEach((function(e){P(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({conversationId:e},n)}(null==t?void 0:t.messages,o);"function"==typeof e&&e(n)})).catch((function(t){(0,l.H)(t,{message:"Failed to get messages"}),"function"==typeof e&&e(null,t)}))};function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function N(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(Object(n),!0).forEach((function(e){T(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function T(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var $=function(t){var e,n=null==t||null===(e=t.data)||void 0===e?void 0:e.map((function(t){return new Promise((function(e){var n;(null==t||null===(n=t.relationships)||void 0===n?void 0:n.attachments)?(0,y.ML)(t.id).then((function(n){e({message:t,attachments:n})})):e({message:t})}))}));return Promise.allSettled(n).then((function(e){var n=[];return e.forEach((function(t){"rejected"!==t.status?n.push(t.value):(0,l.H)(t.reason,{message:"Error appending attachment(s) to historical message"})})),{messages:n,links:null==t?void 0:t.links}}))},F=a(3415),x=a(4353),B=a.n(x),U=a(6762),H=a.n(U);function K(t){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(t)}var J={s:"second",h:"hour",d:"day",w:"week",m:"minute",M:"month"};function z(t,e){var n=t.replace(/_/g,".");return H()(e,n)}function L(t){return null!=t&&("string"==typeof t?""!==t.trim():!Array.isArray(t)||0!==t.length)}function R(t,e){var n;if(Array.isArray(t)&&!Array.isArray(e))return t.includes(e);try{switch(K(t)){case"string":n=String(e);break;case"number":n=Number(e);break;case"boolean":n="boolean"==typeof e?e:"true"===e;break;default:n=e}}catch(t){n=e}return t==n}function q(t,e){if((0,F.Kg)(t)&&(0,F.Kg)(e)){var n=(t||"").toLocaleLowerCase(),r=(e||"").toLocaleLowerCase();return n.includes(r)}return!!(t||[]).filter((function(t){return(t||"").toLocaleLowerCase().includes((e||"").toLocaleLowerCase())})).length}function Y(t,e){return(0,F.Kg)(t)&&Array.isArray(e)?!!e.filter((function(e){return(t||"").toLocaleLowerCase().includes((e||"").toLocaleLowerCase())})).length:!(!Array.isArray(t)||!Array.isArray(e))&&e.some((function(e){return t.some((function(t){var n=(0,F.Kg)(t)?t.toLocaleLowerCase():t,r=(0,F.Kg)(e)?e.toLocaleLowerCase():e;return n.includes(r)}))}))}function W(t,e){return Array.isArray(t)&&Array.isArray(e)?!!(0,F.E$)(t,e).length:(e||[]).includes(t)}function Z(t){return(0,F.Kg)(t)&&B()(t).isValid()}function Q(t){return(0,F.Kg)(t)&&/^(now)[-+]([0-9]|[1-9][0-9])(s|h|d|w|m|M)/g.test(t)}function V(t){var e=t.substring(t.length-1),n=J[e];if(!n)throw new Error("date unit ".concat(e," not supported"));var r=t[3],o=Number(t.substring(4,t.length-1));return"-"===r?B()().subtract(o,n).toJSON():B()().add(o,n).toJSON()}function G(t,e){var n=Object.keys(t)[0],r=t[n],o=r.operator,i=r.value;switch(o){case"is_set":case"not_set":return function(t,e){switch(t){case"is_set":return L(e);case"not_set":return!L(e);default:throw new Error("operation ".concat(t," not supported"))}}(o,z(n,e));case"equals":case"not_equals":case"gt":case"gte":case"lt":case"lte":case"in":case"not_in":case"contains":case"not_contains":case"contains_any_of":case"not_contains_any_of":return function(t,e,n){switch(t){case"equals":return R(e,n);case"not_equals":return!R(e,n);case"gt":return function(t,e){if(Q(e)){var n=V(e);return Date.parse(t)>Date.parse(n)}return Z(e)?Date.parse(t)>Date.parse(e):Number(t)>Number(e)}(e,n);case"gte":return function(t,e){if(Q(e)){var n=V(e);return Date.parse(t)>=Date.parse(n)}return Z(e)?Date.parse(t)>=Date.parse(e):Number(t)>=Number(e)}(e,n);case"lt":return function(t,e){if(Q(e)){var n=V(e);return Date.parse(t)<Date.parse(n)}return Z(e)?Date.parse(t)<Date.parse(e):Number(t)<Number(e)}(e,n);case"lte":return function(t,e){if(Q(e)){var n=V(e);return Date.parse(t)<=Date.parse(n)}return Z(e)?Date.parse(t)<=Date.parse(e):Number(t)<=Number(e)}(e,n);case"in":return W(e,n);case"not_in":return!W(e,n);case"contains":return q(e,n);case"not_contains":return!q(e,n);case"contains_any_of":return Y(e,n);case"not_contains_any_of":return!Y(e,n);default:throw new Error("operation ".concat(t," not supported"))}}(o,z(n,e),i);default:throw new Error("operation ".concat(o," not supported"))}}var X=function(t,e,n){var r={session:e,customer:n};return function(t,e){var n;return null===(n=t.criteria.and)||void 0===n?void 0:n.every((function(t){return G(t,e)}))}(t,r)&&function(t,e){var n=t.criteria.or;return!n||!n.length||!!n.find((function(t){return G(t,e)}))}(t,r)},tt=function(t){var e;return null===(e=t.actions)||void 0===e?void 0:e.find((function(t){var e,n;return"chat"===(null==t||null===(e=t.input)||void 0===e||null===(n=e.pendingAssistant)||void 0===n?void 0:n.channel)}))},et=a(9774),nt=function(t){var e=t.id,r=t.attributes.pubnub.data.channels.find((function(t){return"meta-conversation"===t.type}));return s().then((function(t){var o=t;if((0,n.KA)().isPubNubConnected&&r){var i,a,u={message:{eventType:"read"},channel:r.name};return null===(i=o.getMetaPubNub())||void 0===i||null===(a=i.instance)||void 0===a?void 0:a.publish(u).then((function(){(0,n.yj)(e),(0,et.r)(e)}))}}))},rt=a(991);function ot(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map;return{get:function(e){return new Promise((function(n,r){var o=t.get(e);void 0===o?r():n(o)}))},set:function(e,n){return new Promise((function(r){t.set(e,n),r()}))},toKey:function(t){return Promise.resolve(JSON.stringify(t))}}}function it(t,e){var n=e||ot(),r=n.get,o=n.set,i=n.toKey;return function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return i(n).catch((function(){})).then((function(e){return void 0===e?t.apply(void 0,n):r(e).catch((function(){return t.apply(void 0,n).then((function(t){return o(e,t).then((function(){return t})).catch((function(){return t}))}))}))}))}}var at=a(2838);function ut(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ct(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(n),!0).forEach((function(e){st(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function st(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var lt=it((function(t){var n=(0,at.N0)(t);if(n)return Promise.reject(n);var r=t.assistant,o=t.dialog,i=t.assistantOptions,a={assistant:r,dialog:o},u=null!=i&&i.emulation?ct(ct({},a),{},{assistantOptions:i}):a;return(0,e.bE)((0,at.AG)(t),{body:JSON.stringify(u)})}),ot(at.eI)),ft=["body"];var dt=function(t){var e,n,r;return{aiUserId:null==t||null===(e=t.machineUser)||void 0===e?void 0:e.id,publicName:null==t||null===(n=t.machineUser)||void 0===n?void 0:n.displayName,avatarUrl:null==t||null===(r=t.machineUser)||void 0===r?void 0:r.avatarUrl}},vt=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(t){return t.body,function(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}(t,ft)}))},pt="online",bt="offline",gt=function(t){return{availability:t}},ht=function(t){var e=new Date,n=e.getTime()+6e4*e.getTimezoneOffset();return new Date(n+t)},mt=a(3712),yt=function(t,r){var o;null!=t&&t.jwtToken?o=function(t){var n=function(t){if(!t.externalToken)return new Error("Missing one or more of the required properties: jwtToken")}(t);return n?Promise.reject(n):(0,c.a)().then((function(){return(0,e.bE)("/c/v1/identity",{body:JSON.stringify(t)}).then((function(t){return t}))}))}({externalToken:null==t?void 0:t.jwtToken}).then((function(t){var e,r,o={identified:(r=(e=t).data.attributes).verified,email:r.email,externalId:r.externalId,customerId:e.data.relationships.customer.data.id};return(0,n.fF)("customerId",o.customerId),(0,n.fF)("externalId",o.externalId),(0,n.fF)("email",o.email),(0,n.fF)("verified",o.identified),o})):o=(0,c.u)().then((function(t){var e,r,o,i,a=(0,n.KA)(),u=null==t||null===(e=t.data)||void 0===e||null===(r=e.relationships)||void 0===r||null===(o=r.customer)||void 0===o||null===(i=o.data)||void 0===i?void 0:i.id;return(0,n.fF)("customerId",u),{customerId:u,identified:!!a.verified,externalId:a.externalId,email:a.email}}));return o.then((function(t){var e,o,i=(0,n.KA)();return Array.isArray(null===(e=i.settings)||void 0===e?void 0:e.assistantRules)&&(null===(o=i.settings)||void 0===o?void 0:o.assistantRules.length)>0&&t.identified?(0,mt.He)().catch((function(t){"function"==typeof r&&r(null,t),(0,g.M)(b.QU,null,t),(0,l.H)(t,{message:"Failed to get customer context:"})})).then((function(){return t})):t})).then((function(e){var o=function(){"function"==typeof r&&r(e),(0,g.M)(b.QU,e)};if((0,n.fF)("isPubNubConnected",!1),null!=t&&t.brandId||null!=t&&t.assistantId)return v({brandId:null==t?void 0:t.brandId,assistantId:null==t?void 0:t.assistantId},o);var i=(0,n.KA)().orgId;return s({customerId:e.customerId,orgId:i,cb:o}).then((function(){return e}))})).catch((function(t){"function"==typeof r&&r(null,t),(0,g.M)(b.QU,null,t),(0,l.H)(t,{message:"Failed to identify customer:"})}))},wt=function(t){var e=t.userIdentifier,n=t.externalId,r=t.email;return t.verified&&[n,r].includes(e)};function Ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _t(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ot(Object(n),!0).forEach((function(e){jt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function jt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Pt=function t(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(t){var n=function(t){if(!(null==t?void 0:t.lang))return new Error("Missing one or more of the required properties: lang")}(t);return n?Promise.reject(n):(0,e.Jt)(function(t){var e=null==t?void 0:t.page,n=null==t?void 0:t.lang,o=null==t?void 0:t.knowledgeBaseId,i=(0,r.A0)(n),a="/p/v4/kb/categories?pageSize=1000&page=".concat(e);return i&&(a="".concat(a,"&lang=").concat(i)),o&&(a="".concat(a,"&knowledgeBaseId=").concat(o)),a}(t))}({page:o,lang:null==n?void 0:n.lang,knowledgeBaseId:null==n?void 0:n.knowledgeBaseId}).then((function(e){var r,a=e.data.reduce((function(t,e){var n,r;return t[e.id]=(r=(n=e).attributes,{categoryId:n.id,parentCategory:r.parent,childCategories:r.categoryPositions,title:r.title,description:r.description}),t}),i),u=_t(_t({},i),a);return null!==(r=e.links)&&void 0!==r&&r.next?t(n,o+1,u):i}))},It=function t(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(t){return(0,e.Jt)(function(t){var e=t.lang,n=t.knowledgeBaseId,o=t.page,i=(0,r.A0)(e),a="/p/v4/kb/articles",u=[];return i&&u.push("lang=".concat(i)),n&&u.push("knowledgeBaseId=".concat(n)),o&&u.push("page=".concat(o)),u.length&&(a="".concat(a,"?").concat(u.join("&"))),a}({lang:t.lang,knowledgeBaseId:t.knowledgeBaseId,page:t.page}))}({lang:n.lang,knowledgeBaseId:n.knowledgeBaseId,page:o}).then((function(e){var r;return e.data.find((function(t){return t.attributes.slug===n.articleSlug&&t.attributes.hash===n.articleHash}))||(null!=e&&null!==(r=e.links)&&void 0!==r&&r.next?t(n,o+1):null)}))},kt=a(3064),At=function(t,n){var o=function(t){var e=null==t?void 0:t.articleId,n=null==t?void 0:t.knowledgeBaseId,r=null==t?void 0:t.rating;if(!e||!n||!r)return new Error("Missing one or more of the required properties: articleId, knowledgeBaseId, and rating")}(t);return o?Promise.reject(o):function(t){return(0,e.bE)((n=t.articleId,o=t.lang,i=(0,r.A0)(o),"/p/v4/kb/articles/".concat(n,"/feedback?lang=").concat(i)),{body:JSON.stringify({rating:t.rating,knowledgeBaseId:t.knowledgeBaseId})}).then((function(t){return t.data}));var n,o,i}({knowledgeBaseId:t.knowledgeBaseId,articleId:t.articleId,lang:t.lang,rating:t.rating}).then((function(t){n&&n(t)}))},St=function(t){return function(t){var n=function(t){var e=null==t?void 0:t.categoryId,n=null==t?void 0:t.lang;if(!e||!n)return new Error("Missing one or more of the required properties: lang, categoryId")}(t);return n?Promise.reject(n):(0,e.Jt)(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=t.categoryId,o=t.lang,i=t.knowledgeBaseId,a=(0,r.A0)(o),u="/p/v4/kb/categories/".concat(n,"?includeChildren=true&childrenLimit=").concat(e);return a&&(u="".concat(u,"&lang=").concat(a)),i&&(u="".concat(u,"&knowledgeBaseId=").concat(i)),u}(t))}(t).then((function(t){var e,n=t.data.attributes.positions,r=null==t||null===(e=t.included)||void 0===e?void 0:e.filter((function(t){return"article"===t.type}));return r&&r.length?function(t,e){return t.reduce((function(t,n){var r=e.find((function(t){return t.attributes.article===n}));if(r){var o=(0,kt.$)(r);t.push(o)}return t}),[])}(n,r):[]}))},Et=function(t,n){return function(t){return function(t){return(0,e.Jt)((n=t.knowledgeBaseId,o=null==t?void 0:t.lang,i=(0,r.A0)(o),"/p/v4/kb/featured-articles?knowledgeBaseId=".concat(n,"&lang=").concat(i))).then((function(t){return t.data}));var n,o,i}(t).then((function(t){var e=t;return e&&e.length?e.map((function(t){return(0,kt.$)(t)})):[]}))}(t).then((function(t){var e=(0,kt.u)(t);"function"==typeof n&&n(e)})).catch((function(t){"function"==typeof n&&n(null,t),(0,l.H)(t,{message:"Failed to get articles"})}))},Ct=function(){return(0,n.KA)().settings},Dt=it((function(){var t=Ct();return null!=t&&t.knowledgeBaseId?Promise.resolve(t.knowledgeBaseId):(0,e.Jt)("/p/v4/kb/knowledge-bases/self").then((function(t){return t.data.id}))})),Mt=it((function(t){return(0,e.Jt)((n=t.knowledgeBaseId,o=t.lang,i=(0,r.A0)(o),"/p/v4/kb/knowledge-bases/".concat(n,"?chat=true&lang=").concat(i)));var n,o,i})),Nt=a(7289),Tt=function(t){return Dt().then((function(e){return Mt({knowledgeBaseId:e}).then((function(e){var n=function(t){var e,n,r=t.data.attributes,o=r.domain,i=r.subdomain,a=null!=o&&o.domainName?"https://".concat(null==o?void 0:o.domainName,"/"):function(t){return"https://".concat(t,".").concat((e=(0,Nt._)().baseUrlDomain,null!=e&&e.includes("helpapp")?"helpapp":null!=e&&e.includes("helpsimply")?"helpsimply":"kustomer"),".").concat("prod2"===(0,Nt._)().pod?"support":"help","/");var e}(i);return{id:t.data.id,articleSurvey:null==t||null===(e=t.data)||void 0===e||null===(n=e.attributes)||void 0===n?void 0:n.articleSurvey,knowledgeBaseDomain:a}}(e);return"function"==typeof t&&t(n),n}))})).catch((function(e){return"function"==typeof t&&t(null,e),(0,l.H)(e,{message:"Failed to get knowledge base information"}),{}}))};function $t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ft(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$t(Object(n),!0).forEach((function(e){xt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$t(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function xt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Bt=function(t,n){return(o=t,i=function(t){var e=null==t?void 0:t.term,n=null==t?void 0:t.lang;if(!e||!n)return new Error("Missing one or more of the required properties: lang, term")}(o),i?Promise.reject(i):(0,e.Jt)(function(t){var e=t.term,n=t.lang,o=t.knowledgeBaseId,i=(0,r.A0)(n),a="/p/v4/kb/articles/search?pageSize=100&page=1&term=".concat(e,"&knowledgeBaseId=").concat(o);return i&&(a="".concat(a,"&lang=").concat(i)),a}(o))).then((function(t){var e=t.data.map((function(t){return(0,kt.$)(t)})),r=(0,kt.u)(e);"function"==typeof n&&n(r)})).catch((function(t){"function"==typeof n&&n(null,t),(0,l.H)(t,{message:"Failed to search articles"})}));var o,i};function Ut(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Ht=function(t,e,n){var r=!0,o=e.replace(/\/$/,"");if(!t)return!1;var i,a=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ut(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ut(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}(t);try{for(a.s();!(i=a.n()).done;){var u=i.value.website_url,c=u.operator,s=u.value,l="equals"===c,f="not_equals"===c,d="not_contains"===c,v=e===s||o===s;if("contains"===c&&e.includes(s)||d&&!e.includes(s)||l&&v||f&&e!==s)r=!1;else if("and"===n){r=!0;break}}}catch(t){a.e(t)}finally{a.f()}return r},Kt=a(9860),Jt="online",zt="offline",Lt=a(5564);(0,t.sD)().then((function(){window.KustomerMain={fetchSettings:o,init:function(t,e){v(t,e)},createConversation:function(t,e){!function(t,e){(0,p.jw)(t).then((function(t){var e=t.data.relationships.customer.data.id,r=(0,n.KA)().orgId;return s({customerId:e,orgId:r}).then((function(e){return{pubnub:e,response:t}}))})).then((function(t){var r,o,i,a=t.pubnub,u=t.response;if(!(0,n.KA)().isPubNubConnected)throw new Error("Failed to connect to Pubnub");var c=((null==u||null===(r=u.data)||void 0===r?void 0:r.attributes.pubnub.data)||{}).channels.find((function(t){return"shared-conversation"===t.type})),s=null==c?void 0:c.name,l=s?[s]:void 0;if(l){var f,d,v={status:m({conversationChannels:l},(function(t,n){var r,o,i,c,s=null;n?null===(i=a.getMetaPubNub())||void 0===i||null===(c=i.instance)||void 0===c||c.unsubscribe({channels:l}):s=function(t){var e=t.data.id,n=t.data.attributes;return{conversationId:e,createdAt:n.createdAt,ended:!!n.lockedAt,isInAssistantMode:n.isInAssistantMode}}(u),null==a||null===(r=a.getMetaPubNub())||void 0===r||null===(o=r.instance)||void 0===o||o.removeListener(v),(0,g.M)(b.vn,s,n),"function"==typeof e&&e(s,n)}))};null===(f=a.getMetaPubNub())||void 0===f||null===(d=f.instance)||void 0===d||d.addListener(v)}return null===(o=a.getMetaPubNub())||void 0===o||null===(i=o.instance)||void 0===i||i.subscribe({channels:l}),a})).catch((function(t){"function"==typeof e&&e(null,t),(0,g.M)(b.vn,null,t),(0,l.H)(t,{message:"Failed to create conversation:"})}))}(t,e)},addListener:function(t,e){!function(t,e){!1!==(0,g.v)(t)&&"function"==typeof e&&(0,n.cO)(t,e)}(t,e)},removeListener:function(t,e){!function(t,e){!1!==(0,g.v)(t)&&"function"==typeof e&&(0,n.kw)(t,e)}(t,e)},sendMessage:function(t,e){!function(t,e){var n,r=null==t?void 0:t.conversationId,o=null==t?void 0:t.body,i=null==t?void 0:t.payload,a=null==t?void 0:t.attachments,u=null==t?void 0:t.lastDeflection,c=null==t?void 0:t.isInAssistantMode,s=null==t?void 0:t.initAssistantPayload,f=null==t?void 0:t.lang,d=null==t?void 0:t.assistantOptions;(0,y.oH)(r,{body:o,payload:i,attachments:a,lastDeflection:u,isInAssistantMode:c,initAssistantPayload:s,lang:f,assistantOptions:d}).then((function(t){n=t;var e=t.data.id;if(null!=a&&a.length)return(0,y.R9)(e)})).then((function(t){var r=null==t?void 0:t.data,o=(0,w.e)(n.data,r);(0,g.M)(b.rh,o),"function"==typeof e&&e(o)})).catch((function(t){if("function"==typeof e&&e(null,t),423===t.status){var n={conversationId:r,ended:!0};(0,g.M)(b.LM,n)}(0,g.M)(b.rh,null,t),(0,l.H)(t,{message:"Failed to send message:"})}))}(t,e)},getConversations:function(t,e){!function(t,e){(0,c.a)().then((function(){return(0,p.S5)(t)})).then((function(t){var n=function(t){return{conversations:t.data.filter((function(t){return!0!==t.attributes.deleted})).map((function(t){var e;return{preview:t.attributes.preview,lastResponder:null===(e=t.attributes.previewDetails)||void 0===e?void 0:e.lastResponder,createdAt:t.attributes.createdAt,lastMessageAt:t.attributes.lastMessageAt,conversationId:t.id,ended:!!t.attributes.lockedAt,isInAssistantMode:t.attributes.isInAssistantMode}})),pages:O(t.links)}}(t);return"function"==typeof e&&e(n),t})).catch((function(t){"function"==typeof e&&e(null,t),(0,l.H)(t,{message:"Failed to get conversations for customer:"})}))}(t,e)},getConversation:function(t,e){!function(t,e){var n=null==t?void 0:t.conversationId;(0,p.Ht)(n).then((function(t){var n,r,o={conversationId:(n=t.data).id,createdAt:(r=n.attributes).createdAt,preview:r.preview,lastMessageAt:r.lastMessageAt,ended:!!r.lockedAt};return"function"==typeof e&&e(o),t})).catch((function(t){(0,l.H)(t,{message:"Failed to get conversation:"}),"function"==typeof e&&e(null,t)}))}(t,e)},getMessages:function(t,e){D(t,e)},getHistoricalMessages:function(t,e){!function(t,e){var n=null==t?void 0:t.conversationId,r=(null==t?void 0:t.count)||b.nd,o=null==t?void 0:t.before;(0,y.Nz)(n,{count:r,before:o}).then($).then((function(t){var r=function(t,e,n){var r={satisfaction:{},messages:[]};return null!=t&&t.length&&(r=t.reduce((function(t,e){var n,r,o,i,a,u,c,s,l,f,d;return"chat_message"===e.message.type&&t.messages.push((0,w.e)(e.message,null==e||null===(n=e.attachments)||void 0===n?void 0:n.data,(r=e.message,d=[],null!==(o=r.attributes)&&void 0!==o&&null!==(i=o.meta)&&void 0!==i&&i.template&&d.push({attributes:null===(l=r.attributes)||void 0===l||null===(f=l.meta)||void 0===f?void 0:f.template,type:"template"}),null===(a=r.attributes)||void 0===a||null===(u=a.meta)||void 0===u||null===(c=u.template)||void 0===c||null===(s=c.articles)||void 0===s||s.forEach((function(t){return d.push(N(N({},t),{},{type:"article"}))})),d),"historical")),t}),r)),N(N({conversationId:e},r),{},{links:n})}(null==t?void 0:t.messages,n,t.links);"function"==typeof e&&e(r)})).catch((function(t){"function"==typeof e&&e(null,t),(0,l.H)(t,{message:"Failed to get historical messages"})}))}(t,e)},getAssistant:function(t){return function(t){var e,r,o=(0,n.KA)(),i=null!==(e=t.customer)&&void 0!==e?e:o.customerContext,a=null==o||null===(r=o.settings)||void 0===r?void 0:r.assistantRules,u=!!t.proactiveOnly;if(Array.isArray(a))for(var c=u?a.filter((function(t){var e,n,r;return!0===(null===(e=tt(t))||void 0===e||null===(n=e.input)||void 0===n||null===(r=n.pendingAssistant)||void 0===r?void 0:r.isProactive)})):a,s=0;s<c.length;s++){var l=c[s];if(X(l,t.session,i)){var f,d,v=null===(f=tt(l))||void 0===f||null===(d=f.input)||void 0===d?void 0:d.pendingAssistant;if(!0===(null==l?void 0:l.hasAiAutomationId))return{assistant:"",aiAgentTeamId:null==l?void 0:l.aiAutomationId};if(null!=v&&v.assistant)return{assistant:null==v?void 0:v.assistant,dialog:null==v?void 0:v.startDialog}}}return!(u||!o.settings.activeAssistant)&&{assistant:o.settings.activeAssistant}}(t)},markRead:function(t){!function(t){var e=(0,n.KA)().sessions,r=null==t?void 0:t.conversationId,o=null==t?void 0:t.messageIds;try{var i=(0,et.y)(r);if(i)throw i;return Promise.resolve(e[r]).then((function(t){return t?Promise.resolve(t):(0,p.Ht)(r).then((function(t){return t.data}))})).then((function(t){var e=[nt(t)];return null!=o&&o.length&&e.push(function(t){var e=t.messageIds,n=t.sessionId;return(0,p.WE)({messageIds:e,sessionId:n,body:{read:!0}})}({messageIds:o,sessionId:r})),Promise.all(e)})).catch((function(t){(0,l.H)(t,{message:"Failed to mark message as read"})}))}catch(t){(0,l.H)(t,{message:"Failed to mark message as read"})}}(t)},getUnreadCount:function(){return(0,n.KA)().unreadCounts},endConversation:function(t,e){!function(t,e){var n=null==t?void 0:t.conversationId;(0,p.qO)(n,{locked:!0,lockReason:"customer_ended"}).then((function(t){var n=(0,rt.b)(t.data);"function"==typeof e&&e(n)})).catch((function(t){"function"==typeof e&&e(null,t),(0,l.H)(t,{message:"Failed to end conversation"})}))}(t,e)},initAssistant:function(t,n){return function(t,n){var r=t.aiAgentTeamId;return(0,c.a)().then((function(){return r?(0,e.Jt)("/p/v1/automation-engine/automations-metadata"):lt(t)})).then((function(t){var e;if(r){var o,i,a,u=null==t||null===(o=t.data)||void 0===o?void 0:o.find((function(t){return t.attributes.liveAutomationId===r})),c=null==u?void 0:u.attributes,s=null==c||null===(i=c.proactive)||void 0===i||null===(a=i.chat)||void 0===a?void 0:a.messages;if(!c||null==s||!s.length)return Promise.reject(new Error("Proactive messages not found for AI Agent Team"));e={attributes:dt(c),initialMessages:vt(s)}}else e=t.data;var l,f,d,v,p={assistant:null==(l=e)||null===(f=l.meta)||void 0===f?void 0:f.assistant,dialog:null==l||null===(d=l.meta)||void 0===d?void 0:d.dialog,node:null==l||null===(v=l.meta)||void 0===v?void 0:v.node,initialMessages:null==l?void 0:l.initialMessages,attributes:null==l?void 0:l.attributes};return"function"==typeof n&&n(p),p})).catch((function(t){throw"function"==typeof n&&n(null,t),new Error(t)}))}(t,n)},sendKbDeflectionClick:function(t,n){return function(t,n){return function(t){return(0,e.yJ)((0,at.s5)(t.sessionId),{body:JSON.stringify({articles:t.articles})})}(t).then(n)}(t,n)},isChatAvailable:function(){return function(){var t=(0,n.KA)(),e=t.settings,r=t.schedule,o=e.enabled,i=e.offhoursDisplay;if(!o)return gt("disabled");var a=function(t){var e=t.timezoneOffset,n=t.holidays,r=void 0===n?[]:n,o=ht(e);return r.filter((function(t){return t.attributes.enabled})).some((function(t){var e=new Date(t.attributes.startDate),n=new Date(t.attributes.endDate);return o>=e&&o<=n}))}(r),u=function(t){var e=t.hours,n=t.timezoneOffset,r=ht(n),o=e[r.getDay().toString()];if(!o||!Object.keys(o).length)return!1;var i=60*r.getHours()+r.getMinutes();return!!o.find((function(t){var e=t[0],n=t[1];return i>=e&&i<=n}))}(r)&&!a;return gt(u||i===pt?pt:u||i!==bt?u||"none"!==i?pt:"hidden":bt)}()},getChatSettings:function(){return Ct()},submitSatisfactionForm:function(t,r){!function(t,r){var o,i,a,u,c=t.satisfactionId,f=t.rating,d=t.submittedAt;(o=c,i={rating:f,answers:t.answers,submittedAt:d},a=t.lang,u=(0,_.jk)(o,i),u?Promise.reject(u):(0,e.yJ)((0,_.ZE)(o,a),{body:JSON.stringify(i)})).then((function(t){return function(t,e){var r,o=t.data.relationships.conversation.data.id;return s().then((function(t){return r=t,(0,n.kk)(o)})).then((function(t){if(!t)return(0,p.Ht)(o)})).then((function(){return(0,n.kk)(o)})).then((function(o){var i,a,u,c=null==o||null===(i=o.attributes)||void 0===i||null===(a=i.pubnub)||void 0===a||null===(u=a.data)||void 0===u?void 0:u.channels,s=(0,n.KA)();if(!c)throw new Error("Conversation PubNub channels not found");var l=c.find((function(t){return"conversation"===t.type}));if(s.isPubNubConnected&&l){var f,d,v={message:{eventType:h.sX,data:t.data,included:t.included},channel:null==l?void 0:l.name};null===(f=r.getMetaPubNub())||void 0===f||null===(d=f.instance)||void 0===d||d.publish(v).then((function(n){var r,o=null==t||null===(r=t.included)||void 0===r?void 0:r.find((function(t){return"satisfaction"===t.type})),i=n.timetoken,a=(0,_.FQ)(t.data,i,o);"function"==typeof e&&e(a)}))}}))}(t,r)})).catch((function(t){"function"==typeof r&&r(null,t),(0,l.H)(t,{message:"Failed to submit satisfaction form"})}))}(t,r)},sendTypingActivity:function(t){!function(t){var e=null==t?void 0:t.conversationId,r=null==t?void 0:t.typing;try{var o=function(t,e){return t?"boolean"!=typeof e?new Error("Typing status must be a boolean"):void 0:new Error("A conversationId must be provided.")}(e,r);if(o)throw o;var i=(0,n.KA)(),a=i.settings,u=i.sessions;if(!a.showTypingIndicatorWeb||!u[e])return;return function(t,e){return s().then((function(r){var o=r,i=(0,n.KA)(),a=i.sessions[t];if(a){var u=a.attributes.pubnub.data.channels.find((function(t){return"shared-conversation"===t.type}));if(u){var c,s,l=u.name,f=e?h.x0:h.YA;i.isPubNubConnected&&(null===(c=o.getMetaPubNub())||void 0===c||null===(s=c.instance)||void 0===s||s.signal({channel:l,message:f}))}}}))}(e,r)}catch(t){(0,l.H)(t,{message:"Failed to send typing status"})}}(t)},login:function(t,e){yt(t,e)},isLoggedIn:function(t,e){!function(t,e){var r=(null==t?void 0:t.email)||(null==t?void 0:t.externalId);if(!r)return Promise.resolve(e(!1));var o=(0,n.KA)(),i=o.externalId,a=o.email,u=o.verified;if(void 0!==u){var s=wt({userIdentifier:r,externalId:i,email:a,verified:u});return"function"==typeof e?Promise.resolve(e(s)):s}(0,c.u)().then((function(t){var n=t.data.attributes,o=n.externalId,i=n.email,a=n.verified,u=wt({userIdentifier:r,externalId:o,email:i,verified:a});return"function"==typeof e?e(u):u})).catch((function(t){"function"==typeof e&&e(null,t),(0,l.H)(t,{message:"Failed to check user is logged in:"})}))}(t,e)},describeCustomer:function(t,e){!function(t,e){var n,r={attributes:(n=t.attributes)?Object.entries(n).reduce((function(t,e){var n,r=e[0],o=e[1];return"phones"!==r&&"sharedPhones"!==r||(n=o.map((function(t){return{phone:t}}))),"emails"!==r&&"sharedEmails"!==r||(n=o.map((function(t){return{email:t}}))),t[r]=n||o,t}),{}):{},custom:t.customAttributes};(0,mt.BQ)(r).then((function(t){var n=function(t){var e,n,r,o=t.data,i=o.attributes,a=o.id,u=i.custom,c=null===(e=i.sharedEmails)||void 0===e?void 0:e.map((function(t){return t.email})),s=null===(n=i.sharedPhones)||void 0===n?void 0:n.map((function(t){return t.phone})),l=null===(r=i.sharedSocials)||void 0===r?void 0:r.map((function(t){return{username:t.username,type:t.type}}));return{customerId:a,custom:u,sharedEmails:c,sharedPhones:s,sharedSocials:l,emails:c,phones:s,socials:l}}(t);"function"==typeof e&&e(n)})).catch((function(t){"function"==typeof e&&e(null,t),(0,l.H)(t,{message:"Failed to describe customer:"})}))}(t,e)},describeConversation:function(t,n){!function(t,n){(function(t){var n=function(t){var e=null==t?void 0:t.conversationId,n=null==t?void 0:t.custom;return e?n?void 0:new Error("Missing one or more of the required properties: customAttributes"):new Error("A conversationId must be provided.")}(t);if(n)return Promise.reject(n);var r=t.conversationId,o=t.custom;return(0,e.F6)("/c/v2/conversations/".concat(r),{body:JSON.stringify({custom:o})})})({conversationId:null==t?void 0:t.conversationId,custom:null==t?void 0:t.customAttributes}).then((function(t){var e,r,o=(r=(e=t.data).attributes,{conversationId:e.id,custom:null==r?void 0:r.custom});"function"==typeof n&&n(o)})).catch((function(t){"function"==typeof n&&n(null,t),(0,l.H)(t,{message:"Failed to describe conversation:"})}))}(t,n)},getCategories:function(t,n){!function(t,n){var r={categories:{},rootCategory:{}};(function(t){return(0,e.Jt)(function(t){return null!=t&&t.knowledgeBaseId?"/p/v4/kb/categories/root?knowledgeBaseId=".concat(null==t?void 0:t.knowledgeBaseId):"/p/v4/kb/categories/root"}(t))})(t).then((function(e){var n,o,i;return r.rootCategory=(o=(n=e.data).attributes,i=n.id,{childCategories:o.categoryPositions,categoryId:i}),Pt(t)})).then((function(t){var e=r.rootCategory,o=e.categoryId;r.categories=t,r.categories[o]=e,"function"==typeof n&&n(r)})).catch((function(t){"function"==typeof n&&n(null,t),(0,l.H)(t,{message:"Failed to get categories"})}))}(t,n)},getArticles:function(t,e){!function(t,e){St(t).then((function(t){var n=(0,kt.u)(t);"function"==typeof e&&e(n)})).catch((function(t){"function"==typeof e&&e(null,t),(0,l.H)(t,{message:"Failed to get articles"})}))}(t,e)},getFeaturedArticles:function(t,e){Et(t,e)},getKnowledgeBaseConfig:function(t){return Tt(t)},getArticleById:function(t,n){!function(t,n){(function(t){var n=function(t){var e=null==t?void 0:t.articleId,n=null==t?void 0:t.lang;if(!e||!n)return new Error("Missing one or more of the required properties: articleId, lang")}(t);return n?Promise.reject(n):(0,e.Jt)(function(t){var e=t.articleId,n=t.lang,o=t.knowledgeBaseId,i=(0,r.A0)(n),a="/p/v4/kb/articles/:articleId".replace(":articleId",e),u=[];return i&&u.push("lang=".concat(i)),o&&u.push("knowledgeBaseId=".concat(o)),u.length&&(a="".concat(a,"?").concat(u.join("&"))),a}(t))})(t).then((function(t){var e=(0,kt.$)(t.data);"function"==typeof n&&n(e)})).catch((function(t){"function"==typeof n&&n(null,t),console.error("Failed to get article",t)}))}(t,n)},getArticleBySlug:function(t,e){return function(t,e){return It(t).then((function(t){var n=null;return t&&(n=(0,kt.$)(t)),"function"==typeof e&&e(n),n})).catch((function(t){"function"==typeof e&&e(null,t),console.error("Failed to get article",t)}))}(t,e)},submitArticleFeedback:function(t,e){return At(t,e)},updateArticleFeedback:function(t,n){return function(t,n){var r=function(t){var e,n=null==t?void 0:t.articleId,r=null==t?void 0:t.feedbackId,o=(null==t||null===(e=t.suggestedReasons)||void 0===e?void 0:e.length)||t.writtenFeedback;if(!n||!r||!o)return new Error("Missing one or more of the required properties: articleId, feedbackId, and suggestedReasons or writtenFeedback")}(t);return r?Promise.reject(r):function(t){return(0,e.F6)((n=t.articleId,r=t.id,"/p/v4/kb/articles/".concat(n,"/feedback/").concat(r)),{body:JSON.stringify({suggestedReasons:t.suggestedReasons,writtenFeedback:t.writtenFeedback})}).then((function(t){return t.data}));var n,r}({articleId:t.articleId,id:t.feedbackId,suggestedReasons:t.suggestedReasons||[],writtenFeedback:t.writtenFeedback||""}).then((function(t){n&&n(t)}))}(t,n)},searchArticles:function(t,e){!function(t,e){var r,o=(0,n.KA)(),i=(null==t?void 0:t.knowledgeBaseId)||(null==o||null===(r=o.settings)||void 0===r?void 0:r.knowledgeBaseId);i?Bt(Ft(Ft({},t),{},{knowledgeBaseId:i}),e):Dt().then((function(n){Bt(Ft(Ft({},t),{},{knowledgeBaseId:n}),e)}))}(t,e)},isUrlAllowed:function(t){return function(t){try{var e=function(t){if("string"!=typeof(null==t?void 0:t.url))throw Error("A url must be provided.")}(t);if(e)throw e;return{allowed:!function(t){var e=(0,n.KA)().settings.domainCriteria;if(!e)return!1;var r=e.or,o=e.and,i=Ht(o,t,"and"),a=Ht(r,t,"or"),u=!1;return o&&r?u=!(!i&&!a):r?u=a:o&&(u=i),u}(null==t?void 0:t.url)}}catch(t){(0,l.H)(t,{message:"Failed to determine if url is allowed"})}}(t)},logout:function(t){!function(t){try{(0,n.ez)(),(0,i.NS)(),yt({},(function(e,n){"function"==typeof t&&t(e,n),(0,g.M)(b.hR,e,n)}))}catch(e){"function"==typeof t&&t(null,e),e instanceof Error&&(0,g.M)(b.hR,null,e),(0,l.H)(e,{message:"Failed to logout"})}}(t)},sendPresenceActivity:function(t){!function(t){var e=(0,n.KA)(),r=e.orgId,o=e.customerId;if(o)try{var i=function(t){var e=null==t?void 0:t.presence;return e?[zt,Jt].includes(e)?void 0:new Error("presence must be one of: online, offline"):new Error("A presence value must be provided.")}(t);if(i)throw i;return s().then((function(n){var i,a,u,c,s=n,l=null==t?void 0:t.presence;e.isPubNubConnected&&(l===Jt&&(null===(i=s.getMetaPubNub())||void 0===i||null===(a=i.instance)||void 0===a||a.subscribe({channels:[(0,Kt.u$)(o,r)],withPresence:!0})),l===zt&&(null===(u=s.getMetaPubNub())||void 0===u||null===(c=u.instance)||void 0===c||c.unsubscribe({channels:[(0,Kt.u$)(o,r)]})))}))}catch(t){return void(0,l.H)(t,{message:"Failed to send presence acitivity"})}}(t)},stop:function(){return s().then((function(t){(0,n.ez)(),t.stopPubNub(),(0,n.fF)("isPubNubConnected",!1)}))},kustomerEventCount:function(t){(0,Lt.Oc)(t)},kustomerEventTimerStart:function(t){(0,Lt._s)(t)},kustomerEventTimerStop:function(t){(0,Lt.wb)(t)}};var t=new CustomEvent("kustomer_core_main_ready");window.parent.dispatchEvent(t)}))}()}();
//# sourceMappingURL=core-main.8522a7f627a54bf9c39e.js.map