# DHCP

...

Выбирают из своего пула адреса и посылают ...
Без ip адреса можем отправить предложения по MAC адресу
Тот сервер, который сделал предложение понимает, что оно принято

Адрес не может быть никому выдан
Все серверы, чьими предложениями клиент не воспользовался, возвращают ip адреса и отправляет (серв с ip) квитанцию и начинает аренду ip
Если не было процедуры продления, то клиент независимо от сервера может отказаться от ip-адреса

Если клиент за время аренды загружается, то начинается процедура получения нового адреса,
в течении срока аренды клиент пытается обновить ip-адрес
Когда клиент должен высвободить ip-адрес, все равно выпадает из сетевых взаимодействий. Процедура продления безопасна и сопровождается направленно
(не широковещательный опрос)

Предполагается что есть 1 сервер и он отправляет ip-адреса
2 сервера не взаимодействуют и нет такого протокола, потому что если 2 сервера будут часто обмениваться данных, то возможна выдача дублированных адресов
Механизмы обеспечения и взаимодейсвтия 2х ip серверов

## 3 режима
Когда какой-то клиент отсылает запрос на получение ip-адреса, то оба сервера формируют свои предложения
Только у каждого свой пул (которые не перекрывают друг друга)
Один забирает, второй высвобождлают.

Когда один из серверов не работает, тогда клиенты с истекающим периодом аренды посылают новый запрос, второй сервер подхватит и выдаст адреса из своего диапазона

## Преимущества DHCP:
уменьшается объем ручной работы - настройками можно управлять централизованно

### Минусы DHCP:
Если компьютеры получают ip адреса случайным образом, то администратор не знает адреса своих клиентов
В таком случае надо работать по именам (WINS, Bonjour)

# Служба обеспечения DHCP сетей

Прокси - сервер или сервис задача которого выступить посредником между клиентаом локальной сети и внешними хостами
Прокси в интернете не обеспечивает безопасность.
Таким образом обходят проблемные моменты
Когда подключаемся по прокси ко внешней сети, то все запросы идут от прокси
Есть возможность обойти блокировку и скрыть что к ресурсу обращаемся мы

Точка атаки размазывается по всем клиентам, любой клиент внешней сети может быть атакован
FireWall может помочь

Если есть прокси, то клиент посылает на прокси запрос, который он хочет получить с внещнего сервера, прокси получает ответ и полностью его распаковывает (HTTP Request)

В этой точке он может проанализровать контент и если все норм, то через канал с клиентом отправит его
Обеспечивает точку, в которой из одного соедиенения в другое перекладывается пакет

Использование прокси в малых сетях
Когда был компьютер, на котором был модем, с помощью которого устанавливалось соединение и получали иетнрнет
Так как нет NAT-устройства, в этом случае устанавливалось прокси на модем и клиент отправлял запрос к прокси
Устройтсво с NAT заменили такое устройство

1. NAT-прокси
На какаом уровне работает NAT-прокси? На сетевом
Не может анализовать трафик, выше ip-уровня не поднимается

2. HTTP-прокси для организации работы клиентов с помощтю браузеров протоколом HTTP
клиент должен быть настроен на прокси
3. HTTPS-прокси работает по протоколу HTTPS:
шифрование. Прокси не может просматривать трафик клиентов
Один канал его с клиентом, второй канал его с внешним сервером.
Трафик шифруется и прокси выступает посредником в процессе согласования ключей
В контент он не лезет и кэшированием заниматься не может
Что передается он не знает

4. FTP-прокси (File-transfer protocol)
Знает протокол, умеет контролировать целостность, умеет организовывать взаимодейсвтие с клиентом
Клиент осознанно работает с прокси
Подразумевает докачку, разрыв соединения.

5. Mapping proxy - протокол транспортного уровня
ВСе запросы на этот порт приходящие отправляем на внешний хост X, а клиентам внутренний сети указывается адрес и порт Mapping proxy
Клиент думает что подключается к своему серверу, а на самом деле посылает к прокси,
а ответы возращаются клиенту. Клиент думает что работает с сервером напрямую, но на самом деле есть разрыв в прокси
Для анализа трафика и избегания прямого взаимодейсвтия с сервером
чтобы клиент общался с сервером не напрямую, а через прокси, то нужно запретить ему взаимодействие с сервером напрямую
Клиент с ним установил соединение, а Mapping-прокси без разницы с каким протоколом работать. Он лишь передает TCP-пакеты.

6. SOCKS-proxy
Универсальный, но клиенты с ним взаимодействуют через систему команд
