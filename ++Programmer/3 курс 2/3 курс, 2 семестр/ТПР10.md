**Транспортная задача**.  

Вариант 13

Стоимость доставки единицы груза из каждого пункта отправления в соответствующие пункты назначения задана матрицей тарифов.  

|             |     |     |     |     |        |
| ----------- | --- | --- | --- | --- | ------ |
|             | B1  | B2  | B3  | B4  | Запасы |
| A1          | 7   | 22  | 8   | 9   | 310    |
| A2          | 12  | 14  | 4   | 11  | 310    |
| A3          | 11  | 20  | 15  | 21  | 260    |
| Потребности | 230 | 310 | 160 | 180 |        |


Проверим необходимое и достаточное условие разрешимости задачи.  
∑a = 310 + 310 + 260 = 880  
∑b = 230 + 310 + 160 + 180 = 880  
Условие баланса соблюдается. Запасы равны потребностям. Следовательно, модель транспортной задачи является закрытой.  
Занесем исходные данные в распределительную таблицу.  

|   |   |   |   |   |   |
|---|---|---|---|---|---|
||B1|B2|B3|B4|Запасы|
|A1|7|22|8|9|310|
|A2|12|14|4|11|310|
|A3|11|20|15|21|260|
|Потребности|230|310|160|180||

  
**Этап I. Поиск первого опорного плана**.  
1. Используя _метод северо-западного угла_, построим первый опорный план транспортной задачи.  
План начинается заполняться с верхнего левого угла.  
Искомый элемент равен c11=7. Для этого элемента запасы равны 310, потребности 230. Поскольку минимальным является 230, то вычитаем его.  
x11 = min(310,230) = 230.  

|   |   |   |   |   |
|---|---|---|---|---|
|**7**|22|8|9|**310 - 230 = 80**|
|x|14|4|11|310|
|x|20|15|21|260|
|**230 - 230 = 0**|310|160|180||

  
  
Искомый элемент равен c12=22. Для этого элемента запасы равны 80, потребности 310. Поскольку минимальным является 80, то вычитаем его.  
x12 = min(80,310) = 80.  

|   |   |   |   |   |
|---|---|---|---|---|
|7|**22**|x|x|**80 - 80 = 0**|
|x|14|4|11|310|
|x|20|15|21|260|
|0|**310 - 80 = 230**|160|180||

  
  
Искомый элемент равен c22=14. Для этого элемента запасы равны 310, потребности 230. Поскольку минимальным является 230, то вычитаем его.  
x22 = min(310,230) = 230.  

|   |   |   |   |   |
|---|---|---|---|---|
|7|22|x|x|0|
|x|**14**|4|11|**310 - 230 = 80**|
|x|x|15|21|260|
|0|**230 - 230 = 0**|160|180||

  
  
Искомый элемент равен c23=4. Для этого элемента запасы равны 80, потребности 160. Поскольку минимальным является 80, то вычитаем его.  
x23 = min(80,160) = 80.  

|   |   |   |   |   |
|---|---|---|---|---|
|7|22|x|x|0|
|x|14|**4**|x|**80 - 80 = 0**|
|x|x|15|21|260|
|0|0|**160 - 80 = 80**|180||

  
  
Искомый элемент равен c33=15. Для этого элемента запасы равны 260, потребности 80. Поскольку минимальным является 80, то вычитаем его.  
x33 = min(260,80) = 80.  

|   |   |   |   |   |
|---|---|---|---|---|
|7|22|x|x|0|
|x|14|4|x|0|
|x|x|**15**|21|**260 - 80 = 180**|
|0|0|**80 - 80 = 0**|180||

  
  
Искомый элемент равен c34=21. Для этого элемента запасы равны 180, потребности 180. Поскольку минимальным является 180, то вычитаем его.  
x34 = min(180,180) = 180.  

|   |   |   |   |   |
|---|---|---|---|---|
|7|22|x|x|0|
|x|14|4|x|0|
|x|x|15|**21**|**180 - 180 = 0**|
|0|0|0|**180 - 180 = 0**||

  
  

|   |   |   |   |   |   |
|---|---|---|---|---|---|
||B1|B2|B3|B4|Запасы|
|A1|7[230]|22[80]|8|9|310|
|A2|12|14[230]|4[80]|11|310|
|A3|11|20|15[80]|21[180]|260|
|Потребности|230|310|160|180||

  
В результате получен первый опорный план, который является допустимым, так как все грузы из баз вывезены, потребность потребителей удовлетворена, а план соответствует системе ограничений транспортной задачи.  
2. Подсчитаем число занятых клеток таблицы, их 6, а должно быть m + n - 1 = 6. Следовательно, опорный план является _невырожденным_.  
Значение целевой функции для этого опорного плана равно:  
F(x) = 7*230 + 22*80 + 14*230 + 4*80 + 15*80 + 21*180 = 11890  
**Этап II. Улучшение опорного плана**.  
Проверим оптимальность опорного плана. Найдем _предварительные потенциалы_ ui, vj. по занятым клеткам таблицы, в которых ui + vj = cij, полагая, что u1 = 0.  
u1 + v1 = 7; 0 + v1 = 7; v1 = 7  
u1 + v2 = 22; 0 + v2 = 22; v2 = 22  
u2 + v2 = 14; 22 + u2 = 14; u2 = -8  
u2 + v3 = 4; -8 + v3 = 4; v3 = 12  
u3 + v3 = 15; 12 + u3 = 15; u3 = 3  
u3 + v4 = 21; 3 + v4 = 21; v4 = 18  

|   |   |   |   |   |
|---|---|---|---|---|
||v1=7|v2=22|v3=12|v4=18|
|u1=0|7[230]|22[80]|8|9|
|u2=-8|12|14[230]|4[80]|11|
|u3=3|11|20|15[80]|21[180]|

  
Опорный план не является оптимальным, так как существуют оценки свободных клеток, для которых ui + vj > cij  
(1;3): 0 + 12 > 8; ∆13 = 0 + 12 - 8 = 4 > 0  
(1;4): 0 + 18 > 9; ∆14 = 0 + 18 - 9 = 9 > 0  
(3;2): 3 + 22 > 20; ∆32 = 3 + 22 - 20 = 5 > 0  
max(4,9,5) = 9  
Выбираем максимальную оценку свободной клетки (1;4): 9  
Для этого в перспективную клетку (1;4) поставим знак «+», а в остальных вершинах многоугольника чередующиеся знаки «-», «+», «-».  

|   |   |   |   |   |   |
|---|---|---|---|---|---|
||1|2|3|4|Запасы|
|1|7[230]|22[80][-]|8|9[+]|310|
|2|12|14[230][+]|4[80][-]|11|310|
|3|11|20|15[80][+]|21[180][-]|260|
|Потребности|230|310|160|180||

  
Цикл приведен в таблице (1,4 → 1,2 → 2,2 → 2,3 → 3,3 → 3,4).  
Из грузов хij стоящих в минусовых клетках, выбираем наименьшее, т.е. у = min (2, 3) = 80. Прибавляем 80 к объемам грузов, стоящих в плюсовых клетках и вычитаем 80 из Хij, стоящих в минусовых клетках. В результате получим новый опорный план.  

|   |   |   |   |   |   |
|---|---|---|---|---|---|
||B1|B2|B3|B4|Запасы|
|A1|7[230]|22[0]|8|9[80]|310|
|A2|12|14[310]|4|11|310|
|A3|11|20|15[160]|21[100]|260|
|Потребности|230|310|160|180||

  
Проверим оптимальность опорного плана. Найдем _предварительные потенциалы_ ui, vj. по занятым клеткам таблицы, в которых ui + vj = cij, полагая, что u1 = 0.  
u1 + v1 = 7; 0 + v1 = 7; v1 = 7  
u1 + v2 = 22; 0 + v2 = 22; v2 = 22  
u2 + v2 = 14; 22 + u2 = 14; u2 = -8  
u1 + v4 = 9; 0 + v4 = 9; v4 = 9  
u3 + v4 = 21; 9 + u3 = 21; u3 = 12  
u3 + v3 = 15; 12 + v3 = 15; v3 = 3  

|   |   |   |   |   |
|---|---|---|---|---|
||v1=7|v2=22|v3=3|v4=9|
|u1=0|7[230]|22[0]|8|9[80]|
|u2=-8|12|14[310]|4|11|
|u3=12|11|20|15[160]|21[100]|

  
Опорный план не является оптимальным, так как существуют оценки свободных клеток, для которых ui + vj > cij  
(3;1): 12 + 7 > 11; ∆31 = 12 + 7 - 11 = 8 > 0  
(3;2): 12 + 22 > 20; ∆32 = 12 + 22 - 20 = 14 > 0  
max(8,14) = 14  
Выбираем максимальную оценку свободной клетки (3;2): 20  
Для этого в перспективную клетку (3;2) поставим знак «+», а в остальных вершинах многоугольника чередующиеся знаки «-», «+», «-».  

|   |   |   |   |   |   |
|---|---|---|---|---|---|
||1|2|3|4|Запасы|
|1|7[230]|22[0][-]|8|9[80][+]|310|
|2|12|14[310]|4|11|310|
|3|11|20[+]|15[160]|21[100][-]|260|
|Потребности|230|310|160|180||

  
Цикл приведен в таблице (3,2 → 3,4 → 1,4 → 1,2).  
Из грузов хij стоящих в минусовых клетках, выбираем наименьшее, т.е. у = min (1, 2) = 0. Прибавляем 0 к объемам грузов, стоящих в плюсовых клетках и вычитаем 0 из Хij, стоящих в минусовых клетках. В результате получим новый опорный план.  

|             |        |         |         |         |        |
| ----------- | ------ | ------- | ------- | ------- | ------ |
|             | B1     | B2      | B3      | B4      | Запасы |
| A1          | 7[230] | 22      | 8       | 9[80]   | 310    |
| A2          | 12     | 14[310] | 4       | 11      | 310    |
| A3          | 11     | 20[0]   | 15[160] | 21[100] | 260    |
| Потребности | 230    | 310     | 160     | 180     |        |

  
Проверим оптимальность опорного плана. Найдем _предварительные потенциалы_ ui, vj. по занятым клеткам таблицы, в которых ui + vj = cij, полагая, что u1 = 0.  
u1 + v1 = 7; 0 + v1 = 7; v1 = 7  
u1 + v4 = 9; 0 + v4 = 9; v4 = 9  
u3 + v4 = 21; 9 + u3 = 21; u3 = 12  
u3 + v2 = 20; 12 + v2 = 20; v2 = 8  
u2 + v2 = 14; 8 + u2 = 14; u2 = 6  
u3 + v3 = 15; 12 + v3 = 15; v3 = 3  

|   |   |   |   |   |
|---|---|---|---|---|
||v1=7|v2=8|v3=3|v4=9|
|u1=0|7[230]|22|8|9[80]|
|u2=6|12|14[310]|4|11|
|u3=12|11|20[0]|15[160]|21[100]|

  
Опорный план не является оптимальным, так как существуют оценки свободных клеток, для которых ui + vj > cij  
(2;1): 6 + 7 > 12; ∆21 = 6 + 7 - 12 = 1 > 0  
(2;3): 6 + 3 > 4; ∆23 = 6 + 3 - 4 = 5 > 0  
(2;4): 6 + 9 > 11; ∆24 = 6 + 9 - 11 = 4 > 0  
(3;1): 12 + 7 > 11; ∆31 = 12 + 7 - 11 = 8 > 0  
max(1,5,4,8) = 8  
Выбираем максимальную оценку свободной клетки (3;1): 11  
Для этого в перспективную клетку (3;1) поставим знак «+», а в остальных вершинах многоугольника чередующиеся знаки «-», «+», «-».  

|   |   |   |   |   |   |
|---|---|---|---|---|---|
||1|2|3|4|Запасы|
|1|7[230][-]|22|8|9[80][+]|310|
|2|12|14[310]|4|11|310|
|3|11[+]|20[0]|15[160]|21[100][-]|260|
|Потребности|230|310|160|180||

  
Цикл приведен в таблице (3,1 → 3,4 → 1,4 → 1,1).  
Из грузов хij стоящих в минусовых клетках, выбираем наименьшее, т.е. у = min (3, 4) = 100. Прибавляем 100 к объемам грузов, стоящих в плюсовых клетках и вычитаем 100 из Хij, стоящих в минусовых клетках. В результате получим новый опорный план.  

|   |   |   |   |   |   |
|---|---|---|---|---|---|
||B1|B2|B3|B4|Запасы|
|A1|7[130]|22|8|9[180]|310|
|A2|12|14[310]|4|11|310|
|A3|11[100]|20[0]|15[160]|21|260|
|Потребности|230|310|160|180||

  
Проверим оптимальность опорного плана. Найдем _предварительные потенциалы_ ui, vj. по занятым клеткам таблицы, в которых ui + vj = cij, полагая, что u1 = 0.  
u1 + v1 = 7; 0 + v1 = 7; v1 = 7  
u3 + v1 = 11; 7 + u3 = 11; u3 = 4  
u3 + v2 = 20; 4 + v2 = 20; v2 = 16  
u2 + v2 = 14; 16 + u2 = 14; u2 = -2  
u3 + v3 = 15; 4 + v3 = 15; v3 = 11  
u1 + v4 = 9; 0 + v4 = 9; v4 = 9  

|       |         |         |         |        |
| ----- | ------- | ------- | ------- | ------ |
|       | v1=7    | v2=16   | v3=11   | v4=9   |
| u1=0  | 7[130]  | 22      | 8       | 9[180] |
| u2=-2 | 12      | 14[310] | 4       | 11     |
| u3=4  | 11[100] | 20[0]   | 15[160] | 21     |

  
Опорный план не является оптимальным, так как существуют оценки свободных клеток, для которых ui + vj > cij  
(1;3): 0 + 11 > 8; ∆13 = 0 + 11 - 8 = 3 > 0  
(2;3): -2 + 11 > 4; ∆23 = -2 + 11 - 4 = 5 > 0  
max(3,5) = 5  
Выбираем максимальную оценку свободной клетки (2;3): 4  
Для этого в перспективную клетку (2;3) поставим знак «+», а в остальных вершинах многоугольника чередующиеся знаки «-», «+», «-».  

|             |         |            |            |        |        |
| ----------- | ------- | ---------- | ---------- | ------ | ------ |
|             | 1       | 2          | 3          | 4      | Запасы |
| 1           | 7[130]  | 22         | 8          | 9[180] | 310    |
| 2           | 12      | 14[310][-] | 4[+]       | 11     | 310    |
| 3           | 11[100] | 20[0][+]   | 15[160][-] | 21     | 260    |
| Потребности | 230     | 310        | 160        | 180    |        |

  
Цикл приведен в таблице (2,3 → 2,2 → 3,2 → 3,3).  
Из грузов хij стоящих в минусовых клетках, выбираем наименьшее, т.е. у = min (3, 3) = 160. Прибавляем 160 к объемам грузов, стоящих в плюсовых клетках и вычитаем 160 из Хij, стоящих в минусовых клетках. В результате получим новый опорный план.  

|             |         |         |        |        |        |
| ----------- | ------- | ------- | ------ | ------ | ------ |
|             | B1      | B2      | B3     | B4     | Запасы |
| A1          | 7[130]  | 22      | 8      | 9[180] | 310    |
| A2          | 12      | 14[150] | 4[160] | 11     | 310    |
| A3          | 11[100] | 20[160] | 15     | 21     | 260    |
| Потребности | 230     | 310     | 160    | 180    |        |

  
Проверим оптимальность опорного плана. Найдем _предварительные потенциалы_ ui, vj. по занятым клеткам таблицы, в которых ui + vj = cij, полагая, что u1 = 0.  
u1 + v1 = 7; 0 + v1 = 7; v1 = 7  
u3 + v1 = 11; 7 + u3 = 11; u3 = 4  
u3 + v2 = 20; 4 + v2 = 20; v2 = 16  
u2 + v2 = 14; 16 + u2 = 14; u2 = -2  
u2 + v3 = 4; -2 + v3 = 4; v3 = 6  
u1 + v4 = 9; 0 + v4 = 9; v4 = 9  

|       |         |         |        |        |
| ----- | ------- | ------- | ------ | ------ |
|       | v1=7    | v2=16   | v3=6   | v4=9   |
| u1=0  | 7[130]  | 22      | 8      | 9[180] |
| u2=-2 | 12      | 14[150] | 4[160] | 11     |
| u3=4  | 11[100] | 20[160] | 15     | 21     |


Опорный план является оптимальным, так все оценки свободных клеток удовлетворяют условию ui + vj ≤ cij.  
Минимальные затраты составят: F(x) = 7*130 + 9*180 + 14*150 + 4*160 + 11*100 + 20*160 = 9570  
**Анализ оптимального плана**.  
Из 1-го склада необходимо груз направить к 1-у потребителю (130 ед.), к 4-у потребителю (180 ед.)  
Из 2-го склада необходимо груз направить к 2-у потребителю (150 ед.), к 3-у потребителю (160 ед.)  
Из 3-го склада необходимо груз направить к 1-у потребителю (100 ед.), к 2-у потребителю (160 ед.)
