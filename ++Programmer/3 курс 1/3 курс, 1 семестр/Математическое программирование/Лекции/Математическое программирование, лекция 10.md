## ДФП
Для определения матрицы пользуются следующим рекуррентным соотношением $A_{k+1} = A_k + A_k^c$
где $A_k^c$ - корректирующая матрица

Наиболее предпочтительным является определение матрицы $A_k$ с помощью конечно-разностной аппроксимации вторых производных
$x^{(k+1)} - x^{(k)} = A_k(G_{k+1}-G_k)$ или $▲x^{(k)} = A_k▲G_k$

Однако такую аппроксимацию построить невозможно, поскольку на k-той итерации надо уже знать $x^{(k+1)}$ и $G_{k+1}$

Подставляя в выражение рекурентное соотношение получим 
$▲x^{(k)} = Betta(A_k + A_k^c)▲G_k => A_k^c▲G_k = 1/ Betta$ $▲x^{(k)} - A_k▲G_k$

Отсюда $A_k^c = 1 / Betta ((▲x^{(k)}) Y^T)/(Y^T▲G_k)) - (A_k ▲G_kZ^T)/(Z^T▲G_k)$

Алгоритм ДФП
Шаг 1. Задаем $x^{(0)}, k = 0$. Опредеелням значение градиента нв точке $x^{(0)} G_0 = ▼f(x^{0})$

Полагаем $A_0$ = I = [1 0]
								 [0 1]
В качестве направления поиска из точки $x^{(0)}$ выбирается вектор $d_0 = -G_0$

Шаг 2. Находим значение шага $alpha_k^*$ минимизирующего функцию $f(x^{(k)} + alpha_k d_k)$. Т.е. проводим одномерный поиск вдоль направления $d_k$

Шаг 3. вычисляем $x^{(k+1)} = x^{(k)} + alpha_k^* d_k$.

**Шаг 4**. Проверяем является ли точка $x^{(k+1)}$ точкой минимума функции, например по условию малости градиента $||G_k+1|| <= Eps$, если оно выполняется, то поиск закончен $x^* = x^{(k+1)}$
Иначе переходим к шагу 5

**Шаг 5**. Вычисляем $A_k^c = (▲x^{(k)}▲x^{(k)^T}) / (▲x^{(k)^T}▲G_k) - (A_k▲G_k▲G_k^T A_k)/(▲G+k^T A_k ▲G_k)$

**Шаг 6**. Обновляем матрицу $A+{k+1} = A_k +A_k^c$

**Шаг 7**. Определяем новое направление поиска 


## Конечно-разностная аппроксимация производных

Точность аппроксимации можно повысить путем использования центральной конечной разности:

$df(x)/dx_i = f(X + he_i) - f(X - he_i)/2h$
x = X

Три вида погрешности:
1) **Погрешность отбрасывания**
$f(x+h) = f(x) + hf'(x) + 1/2h^2f''(x)+ ...$

Отсюда ошибка отбрасывания равна остаточному числу тейлоровского разложения

$▲_1 = (f(x+h) - f(x))/h - f'(x) = ф(f, h) - f'(x) ~= 1/2hf''(x)$, где ф(f,h) - приближение (аппроксимация производной правой разностью)

2) **Абсолютная ошибка вычисления функции**
Эта ошибка вычисления функции в точках x и x+h. Это означает что вместо f(x) и f(x+h) в формулу войдут некоторые величины F(x) , F(x+h)
Тогда F(x) = f(x) + Gamma
$F(x+h) = f(x+h) + Gamma_h$
$ф(F, h)$ = $(F(x+h)-F(x))/h$ = $(f(x+h)-f(x))/h + (gamma_h-gamma)/h + (gamma_h - gamma) / h$ = $ф(f, h) + ▲_2$

3) **Ошибка округления**
При машинных арифметических операциях. Эти ошибки малы по сравнению с предыдущими ошибками и их, как правило, не учитывают.

## 6. Сравнение методов и рекомендации по их выбору

