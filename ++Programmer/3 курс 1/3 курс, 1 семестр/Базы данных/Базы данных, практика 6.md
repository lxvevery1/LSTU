Интересные запросы в БД автосервиса
1. **Подсчет количества выполненных заказов для каждого менеджера:**
```
SELECT m.lfp_manager, COUNT(b.number_booking) as num_bookings FROM manager m LEFT JOIN booking b ON m.id_manager = b.id_manager GROUP BY m.lfp_manager;`
```
2. **Поиск всех цветов автомобилей и их количество**
```
SELECT name_color, COUNT(id_equipment) as num_available FROM available GROUP BY name_color;
```

3. **Получение списка комплектаций и их цены для конкретной модели автомобиля**
```
SELECT e.name_equipment, e.price
FROM equipment e
INNER JOIN models m ON e.id_model = m.id_model
WHERE m.name_model = 'Camry';
```

4. **Определение общей суммы оплаты счетов за определенный период** (за год, например)
```
SELECT SUM(payment_summary_bill) as total_payment
FROM bill
WHERE date_bill BETWEEN '2023-01-01' AND '2023-12-31';
```

5. **Получение списка клиентов, которые приобрели больше одного автомобиля**
```
SELECT c.lfp_customer, COUNT(DISTINCT car.id_car) as num_cars
FROM customer c
LEFT JOIN booking ON c.id_customer = booking.id_customer
LEFT JOIN car ON booking.number_booking = car.number_booking
GROUP BY c.lfp_customer
HAVING COUNT(DISTINCT car.id_car) > 1;
```

6. **Получение списка поставщиков, предоставляющих оборудование для определенной модели автомобиля:**
```
SELECT s.name_supplier
FROM supplier s
WHERE EXISTS (
    SELECT 1
    FROM models m
    LEFT JOIN can_put cp ON m.id_model = cp.id_model
    WHERE cp.id_supplier = s.id_supplier
        AND m.name_model = 'X5'
);
```

7. **Найти суммарные расходы клиента на обслуживание (включая оплаченные и неоплаченные счета).**
```
SELECT c.id_customer, c.lfp_customer, COALESCE(SUM(bl.payment_summary_bill)) AS total_expenditure
FROM customer c
LEFT JOIN booking b ON c.id_customer = b.id_customer
LEFT JOIN bill bl ON b.number_booking = bl.number_booking
GROUP BY c.id_customer, c.lfp_customer;
```

8. **Получить список менеджеров и общую сумму оплаченных счетов за их обработанные заказы.**
```
SELECT m.lfp_manager, SUM(bl.payment_summary_bill) AS total_paid_bills
FROM manager m
JOIN booking b ON m.id_manager = b.id_manager
JOIN bill bl ON b.number_booking = bl.number_booking
WHERE bl.payment_summary_bill IS NOT NULL
GROUP BY m.lfp_manager;
```

9. Получить самую дорогую модель автомобиля
```
SELECT m.name_model, MAX(c.price_sell) AS max_car_price
FROM models m
JOIN car c ON m.id_model = c.id_equipment
GROUP BY m.name_model
ORDER BY max_car_price DESC
LIMIT 1;
```
